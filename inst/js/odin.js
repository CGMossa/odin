var odinjs;(()=>{"use strict";var t={886:(t,e)=>{function r(t,e){return new Error("Invalid control parameter: '".concat(t,"' ").concat(e))}function i(t,e){return void 0===t?e:t}Object.defineProperty(e,"__esModule",{value:!0}),e.dopriControl=void 0,e.dopriControl=function(t){void 0===t&&(t={});var e=1e-6,n=1e4,o=1e-6,s=1/0,a=1e-8,u=!1,f=0,h=1/0,l={atol:i(t.atol,e),maxSteps:i(t.maxSteps,n),rtol:i(t.rtol,o),stepSizeMax:i(t.stepSizeMax,s),stepSizeMin:i(t.stepSizeMin,a),stepSizeMinAllow:i(t.stepSizeMinAllow,u),stiffCheck:i(t.stiffCheck,f),tcrit:i(t.tcrit,h)};if(l.maxSteps<1)throw r("maxSteps","must be at least 1");if(l.atol<=0)throw r("atol","must be strictly positive");if(l.rtol<=0)throw r("rtol","must be strictly positive");return l}},742:function(t,e,r){var i,n=this&&this.__extends||(i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},i(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.DDE=e.integrateDDE=void 0;var o=r(223),s=r(660);e.integrateDDE=function(t,e,r,i,n,o){void 0===n&&(n={}),void 0===o&&(o=null);var s=new a(t,e.length,n,o);return s.initialise(r,e),s.run(i)};var a=function(t){function e(e,r,i,n){void 0===i&&(i={}),void 0===n&&(n=null);var o=this,s=function(t){return o._interpolate(t)},a=null===n?null:function(t,e){return n(t,e,s)};return(o=t.call(this,(function(t,r,i){return e(t,r,i,s)}),r,i,a)||this)._y0=new Array(r),o}return n(e,t),e.prototype.initialise=function(e,r){return this._y0=r,t.prototype.initialise.call(this,e,r),this},e.prototype._interpolate=function(t){var e=this._findHistory(t);return e<0?this._y0.slice(0):this._stepper.interpolate(t,this._history[e])},e.prototype._findHistory=function(t){return(0,s.search)(this._history,(function(e){return e.t>t}))},e}(o.Dopri);e.DDE=a},223:function(t,e,r){var i=this&&this.__createBinding||(Object.create?function(t,e,r,i){void 0===i&&(i=r);var n=Object.getOwnPropertyDescriptor(e,r);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,i,n)}:function(t,e,r,i){void 0===i&&(i=r),t[i]=e[r]}),n=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.prototype.hasOwnProperty.call(t,r)&&i(e,t,r);return n(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Dopri=e.integrateDopri=void 0;var s=r(886),a=o(r(922)),u=r(216),f=o(r(660)),h=Math.pow(2,-52);function l(t,e){return new Error("Integration failure: ".concat(t," at ").concat(e))}e.integrateDopri=function(t,e,r,i,n,o){void 0===n&&(n={}),void 0===o&&(o=null);var s=new c(t,e.length,n,o);return s.initialise(r,e),s.run(i)};var c=function(){function t(t,e,r,i){void 0===r&&(r={}),void 0===i&&(i=null),this._history=[],this._t=0,this._h=0,this._nSteps=0,this._nStepsAccepted=0,this._nStepsRejected=0,this._stiffNStiff=0,this._stiffNNonstiff=0,this._lastError=0,this._stepper=new a.Dopri5(t,e),this._control=(0,s.dopriControl)(r),this._output=i}return t.prototype.initialise=function(t,e){var r=this._stepper.n;if(e.length!==r)throw Error("Invalid size 'y' - expected a length ".concat(r," array"));return this._stepper.reset(t,e),this._reset(),this._h=function(t,e,r,i,n,o){var s=new Array(t.n),a=new Array(t.n),u=new Array(t.n);t.rhs(e,r,s),t.nEval++;var h=0,l=0,c=0;for(c=0;c<t.n;++c){var p=i+n*Math.abs(r[c]);h+=f.square(s[c]/p),l+=f.square(r[c]/p)}var d=h<=1e-10||l<=1e-10?1e-6:.01*Math.sqrt(l/h);for(d=Math.min(d,o),c=0;c<t.n;++c)u[c]=r[c]+d*s[c];t.rhs(e+d,u,a),t.nEval++;var y=0;for(c=0;c<t.n;++c)p=i+n*Math.abs(r[c]),y+=f.square((a[c]-s[c])/p);y=Math.sqrt(y)/d;var v=Math.max(Math.abs(y),Math.sqrt(h)),_=v<=1e-15?Math.max(1e-6,.001*Math.abs(d)):Math.pow(.01/v,1/t.order);return Math.min(Math.min(100*Math.abs(d),_),o)}(this._stepper,t,e,this._control.atol,this._control.rtol,this._control.stepSizeMax),this._t=t,this._history=[],this},t.prototype.run=function(t){for(;this._t<t;)this._step(),this._history.push(this._stepper.history.clone());return(0,u.interpolator)(this._history.slice(0),this._stepper,this._output)},t.prototype.statistics=function(){return{lastError:this._lastError,nEval:this._stepper.nEval,nSteps:this._nSteps,nStepsAccepted:this._nStepsAccepted,nStepsRejected:this._nStepsRejected,stiffNNonstiff:this._stiffNNonstiff,stiffNStiff:this._stiffNStiff}},t.prototype._reset=function(){this._nSteps=0,this._nStepsAccepted=0,this._nStepsRejected=0,this._stiffNStiff=0,this._stiffNNonstiff=0,this._lastError=0},t.prototype._step=function(){for(var t=this._t,e=this._h,r=!1,i=!1,n=Math.max(this._lastError,1e-4),o=this._stepper.stepControl,s=this._control;!r;){if(this._nSteps>s.maxSteps)throw l("too many steps",t);if(e<s.stepSizeMin){if(!s.stepSizeMinAllow)throw l("step too small",t);e=s.stepSizeMin}if(e<=Math.abs(t)*h)throw l("step size vanished",t);t+e>s.tcrit&&(e=s.tcrit-t),this._stepper.step(t,e),this._nSteps++;var a=this._stepper.error(s.atol,s.rtol),u=Math.pow(a,o.constant),c=1/o.factorMin,p=1/o.factorMax;if(a<=1){if(r=!0,this._nStepsAccepted++,this._isStiff(e))throw l("problem became stiff",t);this._stepper.stepComplete(t,e);var d=u/Math.pow(n,o.beta),y=e/(d=f.constrain(d/o.factorSafe,p,c));this._t+=e,this._h=i?Math.min(y,e):Math.min(y,s.stepSizeMax),this._lastError=a}else i=!0,this._nStepsAccepted>=1&&this._nStepsRejected++,e/=Math.min(c,u/o.factorSafe)}return this._t},t.prototype._isStiff=function(t){if(this._stiffNStiff>0||this._nStepsAccepted%this._control.stiffCheck==0)if(this._stepper.isStiff(t)){if(this._stiffNNonstiff=0,this._stiffNStiff++>=15)return!0}else this._stiffNStiff>0&&this._stiffNNonstiff++>=6&&(this._stiffNStiff=0,this._stiffNNonstiff=0);return!1},t}();e.Dopri=c},134:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Dopri5StepControl=void 0;e.Dopri5StepControl=function(){this.factorSafe=.9,this.factorMin=.2,this.factorMax=10,this.beta=.04,this.constant=.2-.75*this.beta}},922:function(t,e,r){var i=this&&this.__createBinding||(Object.create?function(t,e,r,i){void 0===i&&(i=r);var n=Object.getOwnPropertyDescriptor(e,r);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,i,n)}:function(t,e,r,i){void 0===i&&(i=r),t[i]=e[r]}),n=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.prototype.hasOwnProperty.call(t,r)&&i(e,t,r);return n(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Dopri5=void 0;var s=o(r(660)),a=o(r(134)),u=r(430),f=function(){function t(t,e){this.order=5,this.stepControl=new a.Dopri5StepControl,this.nEval=0,this.rhs=t,this.n=e,this.y=new Array(e),this.yNext=new Array(e),this.yStiff=new Array(e),this.k1=new Array(e),this.k2=new Array(e),this.k3=new Array(e),this.k4=new Array(e),this.k5=new Array(e),this.k6=new Array(e),this.history=new u.HistoryElement(this.order*e)}return t.prototype.step=function(t,e){var r=this.n,i=this.y,n=this.yNext,o=this.k1,s=this.k2,a=this.k3,u=this.k4,f=this.k5,h=this.k6,l=this.history.data,c=0;for(c=0;c<r;++c)n[c]=i[c]+.2*e*o[c];for(this.rhs(t+.2*e,n,s),c=0;c<r;++c)n[c]=i[c]+e*(.075*o[c]+.225*s[c]);for(this.rhs(t+.3*e,n,a),c=0;c<r;++c)n[c]=i[c]+e*(.9777777777777777*o[c]+-3.7333333333333334*s[c]+3.5555555555555554*a[c]);for(this.rhs(t+.8*e,n,u),c=0;c<r;++c)n[c]=i[c]+e*(2.9525986892242035*o[c]+-11.595793324188385*s[c]+9.822892851699436*a[c]+-.2908093278463649*u[c]);for(this.rhs(t+.8888888888888888*e,n,f),c=0;c<r;++c)this.yStiff[c]=i[c]+e*(2.8462752525252526*o[c]+-10.757575757575758*s[c]+8.906422717743473*a[c]+.2784090909090909*u[c]+-.2735313036020583*f[c]);var p=t+e;for(this.rhs(p,this.yStiff,h),c=0;c<r;++c)n[c]=i[c]+e*(.09114583333333333*o[c]+.44923629829290207*a[c]+.6510416666666666*u[c]+-.322376179245283*f[c]+.13095238095238096*h[c]);this.rhs(p,n,s);var d=4*r;for(c=0;c<r;++c)l[d++]=e*(-1.1270175653862835*o[c]+2.675424484351598*a[c]+-5.685526961588504*u[c]+3.5219323679207912*f[c]+-1.7672812570757455*h[c]+2.382468931778144*s[c]);for(c=0;c<r;++c)u[c]=e*(.0012326388888888888*o[c]+-.0042527702905061394*a[c]+.03697916666666667*u[c]+-.05086379716981132*f[c]+.0419047619047619*h[c]+-.025*s[c]);this.nEval+=6},t.prototype.stepComplete=function(t,e){this.saveHistory(t,e),s.copyArray(this.k1,this.k2),s.copyArray(this.y,this.yNext)},t.prototype.error=function(t,e){var r=0,i=0;for(i=0;i<this.n;++i){var n=t+e*Math.max(Math.abs(this.y[i]),Math.abs(this.yNext[i]));r+=s.square(this.k4[i]/n)}return Math.sqrt(r/this.n)},t.prototype.interpolate=function(t,e){for(var r=e.data,i=(t-e.t)/e.h,n=1-i,o=this.n,s=new Array(o),a=0;a<o;++a)s[a]=r[a]+i*(r[o+a]+n*(r[2*o+a]+i*(r[3*o+a]+n*r[4*o+a])));return s},t.prototype.isStiff=function(t){for(var e=0,r=0,i=0;i<this.n;++i)e+=s.square(this.k2[i]-this.k6[i]),r+=s.square(this.yNext[i]-this.yStiff[i]);return r>0&&Math.abs(t)*Math.sqrt(e/r)>3.25},t.prototype.reset=function(t,e){for(var r=0;r<this.n;++r)this.y[r]=e[r];this.rhs(t,e,this.k1),this.nEval=1},t.prototype.saveHistory=function(t,e){for(var r=this.history,i=this.n,n=0;n<i;++n){var o=this.yNext[n]-this.y[n],s=e*this.k1[n]-o;r.data[n]=this.y[n],r.data[i+n]=o,r.data[2*i+n]=s,r.data[3*i+n]=-e*this.k2[n]+o-s}r.t=t,r.h=e},t}();e.Dopri5=f},606:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.HistoryElement=void 0;var r=function(){function t(t){this.t=0,this.h=0,this.data=new Array(t)}return t.prototype.clone=function(){var e=new t(this.data.length);return e.t=this.t,e.h=this.h,e.data=this.data.slice(0),e},t}();e.HistoryElement=r},245:(t,e,r)=>{e.BJ=e.sN=void 0;var i=r(223);Object.defineProperty(e,"sN",{enumerable:!0,get:function(){return i.Dopri}});var n=r(742);Object.defineProperty(e,"BJ",{enumerable:!0,get:function(){return n.DDE}});r(961)},961:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.integrate=void 0;var i=r(742),n=r(223);e.integrate=function(t,e,r,o,s,a){if(void 0===s&&(s={}),void 0===a&&(a=null),function(t){return 3===t.length}(t)){if(!function(t){return null===t||2===t.length}(a))throw new Error("Can't used delayed output with non-delayed rhs");return(0,n.integrateDopri)(t,e,r,o,s,a)}if(!function(t){return null===t||3===t.length}(a))throw new Error("Can't used non-delayed output with delayed rhs");return(0,i.integrateDDE)(t,e,r,o,s,a)}},216:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.interpolator=void 0,e.interpolator=function(t,e,r){return function(i){return function(t,e,r,i){for(var n=[],o=e,s=0,a=0,u=t;a<u.length;a++){for(var f=u[a];o[s].t+o[s].h<f;)s++;var h=r.interpolate(f,o[s]);null!==i&&(h=h.concat(i(f,h))),n.push(h)}return n}(i,t,e,r)}}},430:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.HistoryElement=void 0;var i=r(606);Object.defineProperty(e,"HistoryElement",{enumerable:!0,get:function(){return i.HistoryElement}})},660:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.search=e.seqLen=e.approxEqualArray=e.approxEqual=e.zeros=e.copyArray=e.constrain=e.square=void 0;var r=Math.pow(2,-26);e.square=function(t){return t*t},e.constrain=function(t,e,r){return Math.max(Math.min(t,r),e)},e.copyArray=function(t,e){for(var r=t.length,i=0;i<r;i++)t[i]=e[i]},e.zeros=function(t){for(var e=Array(t),r=0;r<t;++r)e[r]=0;return e},e.approxEqual=function(t,e,i){void 0===i&&(i=r);var n=Math.abs(t-e),o=Math.abs(t);return o>i&&(n/=o),n<i},e.approxEqualArray=function(t,e,i){if(void 0===i&&(i=r),e.length!==t.length)throw Error("Incompatible arrays");for(var n=0,o=0,s=0,a=0;a<t.length;++a)t[a]!==e[a]&&(n+=Math.abs(t[a]),o+=Math.abs(t[a]-e[a]),s++);return 0===s||(o/=s,(n/=s)>i&&(o/=n),o<i)},e.seqLen=function(t,e,r){for(var i=[],n=0;n<r;++n){var o=n/(r-1);i.push((1-o)*t+o*e)}return i},e.search=function(t,e){var r=0,i=t.length-1;if(0===t.length||e(t[r]))return-1;if(!e(t[i]))return i;for(;i-r>1;){var n=Math.floor((r+i)/2);e(t[n])?i=n:r=n}return r}}},e={};function r(i){var n=e[i];if(void 0!==n)return n.exports;var o=e[i]={exports:{}};return t[i].call(o.exports,o,o.exports,r),o.exports}r.d=(t,e)=>{for(var i in e)r.o(e,i)&&!r.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var i={};(()=>{function t(t){return.5===e(t,1)?2*Math.round(t/2):Math.round(t)}function e(t,e){let r=t%e;return r*e<0&&(r+=e),r}function n(t,e){return Array.isArray(t)?t={data:t,dim:[t.length]}:"number"==typeof t&&(t={data:[t],dim:[1]}),t}function o(t,e,r){if(e.dim.length!==t)throw 1===t?Error(`Expected a numeric vector for '${r}'`):2===t?Error(`Expected a numeric matrix for '${r}'`):Error(`Expected a numeric array of rank ${t} for '${r}'`)}function s(t,e,r,i,n){for(const o of t.data){if(null===o)throw Error(`'${n}' must not contain any NA values`);a(o,e,r,i,n)}}function a(t,e,r,i,n){if("number"!=typeof t)throw Error(`Expected a number for '${n}'`);if(t<e)throw Error(`Expected '${n}' to be at least ${e}`);if(t>r)throw Error(`Expected '${n}' to be at most ${r}`);if(i&&!Number.isInteger(t))throw Error(`Expected '${n}' to be integer-like`)}r.r(i),r.d(i,{PkgWrapper:()=>c,base:()=>u,wodinRun:()=>l});const u={delay:function(t,e,r,i){const n=t(e);for(let t=0;t<r.length;++t)i[t]=n[r[t]]},maths:{intdivr:function(t,e){return Math.floor(t/e)},modr:e,odinSum1:function(t,e,r){let i=0;for(let n=e;n<r;++n)i+=t[n];return i},odinSum2:function(t,e,r,i,n,o){let s=0;for(let a=i;a<n;++a){const i=a*o;for(let n=e;n<r;++n)s+=t[n+i]}return s},odinSum3:function(t,e,r,i,n,o,s,a,u){let f=0;for(let h=o;h<s;++h){const o=h*u;for(let s=i;s<n;++s){const i=s*a+o;for(let n=e;n<r;++n)f+=t[n+i]}}return f},round2:function(e,r){if(void 0===r||0===r)return t(e);{const i=Math.pow(10,r);return t(e*i)/i}}},user:{checkUser:function(t,e,r){if("ignore"===r)return;const i=[];for(const r of t.keys())e.includes(r)||i.push(r);if(i.length>0){const t="Unknown user parameters: "+i.join(", ");if("message"===r)console.log(t);else{if("warning"!==r)throw"stop"===r?Error(t):Error(t+" (and invalid value for unusedUserAction)");console.warn(t)}}},setUserArrayFixed:function(t,e,r,i,a,u,f){let h=t.get(e);if(void 0===h){if(void 0!==r[e])return;throw Error(`Expected a value for '${e}'`)}{const t=i.length-1;h=n(h),o(t,h,e),function(t,e,r){const i=t.length-1;for(let n=0;n<i;++n){const o=t[n+1];if(e.dim[n]!==o)throw 1===i?Error(`Expected length ${o} value for '${r}'`):Error(`Incorrect size of dimension ${n+1} of '${r}' (expected ${o})`)}}(i,h,e),s(h,a,u,f,e),r[e]=h.data.slice()}},setUserArrayVariable:function(t,e,r,i,a,u,f){let h=t.get(e);if(void 0===h){if(void 0!==r[e])return;throw Error("Expected a value for '"+e+"'")}{const t=i.length-1;h=n(h),o(t,h,e),s(h,a,u,f,e),i[0]=h.data.length;for(let e=0;e<t;++e)i[e+1]=h.dim[e];r[e]=h.data.slice()}},setUserScalar:function(t,e,r,i,n,o,s){const u=t.get(e);if(void 0===u){if(void 0!==r[e])return;if(null===i)throw Error(`Expected a value for '${e}'`);r[e]=i}else{if("number"!=typeof u)throw Error(`Expected a number for '${e}'`);a(u,n,o,s,e),r[e]=u}}}};var f=r(245);function h(t,e,r,i,n){return function(t){return 4===t.rhs.length}(t)?function(t,e,r,i,n){let o=null;"function"==typeof t.output&&(o=(e,r,i)=>t.output(e,r,i)),null===e&&(e=t.initial(r)),t.getInternal().initial_t=r;const s=new f.BJ((function(e,r,i,n){t.rhs(e,r,i,n)}),e.length,n,o);return s.initialise(r,e),{solution:s.run(i),statistics:s.statistics()}}(t,e,r,i,n):function(t,e,r,i,n){let o=null;"function"==typeof t.output&&(o=(e,r)=>t.output(e,r)),null===e&&(e=t.initial(r));const s=new f.sN((function(e,r,i){t.rhs(e,r,i)}),e.length,n,o);return s.initialise(r,e),{solution:s.run(i),statistics:s.statistics()}}(t,e,r,i,n)}function l(t,e,r,i,n){const o=new t(u,e,"error"),s=h(o,null,r,i,n).solution,a=o.names();return(t,e,n)=>{const o=function(t,e,r){const i=(e-t)/(r-1),n=[];for(let e=0;e<r-1;++e)n.push(t+e*i);return n.push(e),n}(Math.max(t,r),Math.min(e,i),n),u=s(o);return u[0].map(((t,e)=>({name:a[e],x:o,y:u.map((t=>t[e]))})))}}class c{constructor(t,e,r){this.model=new t(u,e,r)}initial(t){return this.model.initial(t)}rhs(t,e){const r=new Array(e.length).fill(0);let i=null;if(3!==this.model.rhs.length)throw Error("Can't use rhs() with delay models");return this.model,this.model.rhs(t,e,r),this.model.output&&(i=this.model.output(t,e)),{output:i,state:r}}getMetadata(){return this.model.getMetadata()}getInternal(){return this.model.getInternal()}setUser(t,e){this.model.setUser(t,e)}run(t,e,r){const i=t[0],n=t[t.length-1],o=h(this.model,e,i,n,r);return{names:this.model.names(),statistics:o.statistics,y:o.solution(t)}}}})(),odinjs=i})();