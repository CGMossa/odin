var odinjs;(()=>{"use strict";var t={6:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.interpolateSearch=e.InterpolatorBase=void 0;var r=function(){function t(t,e){(function(t){return Array.isArray(t[0])})(e)||(e=[e]),this._i=0,this._x=t,this._y=e,this.nX=this._x.length,this.nY=this._y.length;for(var r=0;r<this.nY;++r)if(this._y[r].length!==this.nX)throw Error("Invalid length for 'y', expected ".concat(this.nX))}return t.prototype.evalAll=function(t){for(var e=Array(this.nY),r=0;r<this.nY;++r)e[r]=this.eval(t,r);return e},t.prototype.search=function(t,e){var r=n(t,this._x,this._i);if(r<0||!e&&r===this.nX)throw Error("Interpolation failed as 'x' is out of range");return this._i=r,r},t}();function n(t,e,r){var n=r,o=r,i=1,a=e.length;if(e[n]<=t){if(n>=a-1)return a;for(o=n+i;e[o]<t;)if(n=o,(o+=i*=2)>=a){if(e[o=a-1]<t)return a;break}}else{if(0===n)return-1;for(n-=i;e[n]>t;){if(o=n,n<(i*=2)){if(e[n=0]>t)return-1;break}n-=i}}for(;o-n>1;){var s=Math.floor((o+n)/2);e[s]<t?n=s:o=s}return n}e.InterpolatorBase=r,e.interpolateSearch=n},731:function(t,e,r){var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.InterpolatorConstant=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.eval=function(t,e){void 0===e&&(e=0);var r=Math.min(this.search(t,!0),this.nX-1);return r!==this.nX-1&&this._x[r+1]===t&&++r,this._y[e][r]},e}(r(6).InterpolatorBase);e.InterpolatorConstant=i},673:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.InterpolatorSpline=e.InterpolatorLinear=e.InterpolatorConstant=e.InterpolatorBase=void 0;var n=r(6);Object.defineProperty(e,"InterpolatorBase",{enumerable:!0,get:function(){return n.InterpolatorBase}});var o=r(731);Object.defineProperty(e,"InterpolatorConstant",{enumerable:!0,get:function(){return o.InterpolatorConstant}});var i=r(477);Object.defineProperty(e,"InterpolatorLinear",{enumerable:!0,get:function(){return i.InterpolatorLinear}});var a=r(869);Object.defineProperty(e,"InterpolatorSpline",{enumerable:!0,get:function(){return a.InterpolatorSpline}})},477:function(t,e,r){var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.InterpolatorLinear=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.eval=function(t,e){void 0===e&&(e=0);var r=this.search(t,!1),n=this._x[r],o=(t-n)/(this._x[r+1]-n),i=this._y[e],a=i[r];return a+(i[r+1]-a)*o},e}(r(6).InterpolatorBase);e.InterpolatorLinear=i},869:function(t,e,r){var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.solve=e.InterpolatorSpline=void 0;var a=i(r(863)),s=function(t){function e(e,r){var n=t.call(this,e,r)||this,o=function(t){var e=t.length,r=Array(e),n=Array(e),o=Array(e);r[0]=0,n[0]=2/(t[1]-t[0]),o[0]=1/(t[1]-t[0]);for(var i=1;i<e-1;++i){var a=t[i-1],s=t[i],u=t[i+1];r[i]=1/(s-a),n[i]=2*(1/(s-a)+1/(u-s)),o[i]=1/(u-s)}return r[e-1]=1/(t[e-1]-t[e-2]),n[e-1]=2/(t[e-1]-t[e-2]),o[e-1]=0,[r,n,o]}(n._x),i=function(t,e){for(var r=t.length,n=e.length,o=r-1,i=[],a=0;a<n;++a){var s=Array(r),u=e[a];s[0]=3*(u[1]-u[0])/Math.pow(t[1]-t[0],2);for(var l=1;l<o;++l){var c=t[l-1],f=t[l],h=t[l+1],p=u[l-1],d=u[l],v=u[l+1];s[l]=3*((d-p)/Math.pow(f-c,2)+(v-d)/Math.pow(h-f,2))}s[o]=3*(u[o]-u[o-1])/Math.pow(t[o]-t[o-1],2),i.push(s)}return i}(n._x,n._y);return n._k=function(t,e){for(var r=t[0],n=t[1],o=t[2],i=r.length,a=0,s=e;a<s.length;a++){var l=s[a];u(i,r,n.slice(),o,l)}return e}(o,i),n}return o(e,t),e.prototype.eval=function(t,e){void 0===e&&(e=0);var r=this.search(t,!1);return Array(this.nY),function(t,e,r,n,o){var i=(e-r[t])/(r[t+1]-r[t]),a=o[t]*(r[t+1]-r[t])-(n[t+1]-n[t]),s=-o[t+1]*(r[t+1]-r[t])+(n[t+1]-n[t]);return(1-i)*n[t]+i*n[t+1]+i*(1-i)*(a*(1-i)+s*i)}(r,t,this._x,this._y[e],this._k[e])},e}(r(6).InterpolatorBase);function u(t,e,r,n,o){if(!(0,a.default)(t,e,r,n,o))throw Error("solve failed: singular matrix?")}e.InterpolatorSpline=s,e.solve=u},394:(t,e)=>{function r(t,e){return void 0===t?e:t}Object.defineProperty(e,"__esModule",{value:!0}),e.simplexControl=void 0,e.simplexControl=function(t){void 0===t&&(t={});var e={deltaNonZero:r(t.deltaNonZero,.05),deltaZero:r(t.deltaZero,.001),errorOnFailure:r(t.errorOnFailure,!1),tolerance:r(t.tolerance,1e-5)};if(e.tolerance<=0)throw new Error("Invalid control parameter: 'tolerance' must be strictly positive");return e}},153:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0});var n=r(169);Object.defineProperty(e,"Simplex",{enumerable:!0,get:function(){return n.Simplex}}),Object.defineProperty(e,"fitSimplex",{enumerable:!0,get:function(){return n.fitSimplex}})},169:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Simplex=e.fitSimplex=void 0;var n=r(394),o=r(3);function i(t,e,r){for(var n=e.length,o=new Array(n),i=1+t,a=-t,s=0;s<o.length;++s)o[s]=i*e[s]+a*r[s];return o}e.fitSimplex=function(t,e,r,n){return void 0===r&&(r={}),void 0===n&&(n=200),new a(t,e,r).run(n*e.length)};var a=function(){function t(t,e,r){void 0===r&&(r={}),this.rho=1,this.chi=2,this.psi=-.5,this.sigma=.5,this._iterations=0,this._id=0,this._converged=!1,this._target=t,this._control=n.simplexControl(r),this._n=e.length,this._simplex=[],this._simplex.push(this._point(e.slice())),r.errorOnFailure||(this._target=function(t){return function(e){try{return t(e)}catch(t){return 1/0}}}(t));for(var o=0;o<this._n;++o){var i=e.slice();i[o]?i[o]*=1+this._control.deltaNonZero:i[o]=this._control.deltaZero,this._simplex.push(this._point(i))}this._sort()}return t.prototype.step=function(){if(this._iterations++,this._isConverged())return this._converged=!0,!0;var t=this._n,e=this._simplex[0],r=this._simplex[t],n=this._centroid(),o=this._reflect(r,n);if(o.value<e.value){var i=this._expand(r,n);this._update(i.value<o.value?i:o)}else if(o.value>=this._simplex[t-1].value){var a=o.value>r.value?this._contractInside(r,n):this._contractOutside(r,n);if(a.value<r.value)this._update(a);else{for(var s=1;s<=t;++s)this._simplex[s]=this._shrink(this._simplex[s],e.location);this._sort()}}else this._update(o);return!1},t.prototype.run=function(t){if(!this._converged)for(var e=0;e<t&&!this.step();++e);return this.result()},t.prototype.result=function(){var t=this._simplex[0];return{converged:this._converged,data:t.data,evaluations:this._id,iterations:this._iterations,location:t.location,value:t.value}},t.prototype.simplex=function(){return this._simplex.map((function(t){return{location:t.location,value:t.value}}))},t.prototype._point=function(t){var e=o.checkResult(this._target(t));return{data:e.data,id:this._id++,location:t,value:e.value}},t.prototype._sort=function(){this._simplex.sort((function(t,e){return t.value-e.value}))},t.prototype._centroid=function(){for(var t=this._n,e=new Array(t),r=0;r<t;++r){e[r]=0;for(var n=0;n<t;++n)e[r]+=this._simplex[n].location[r];e[r]/=t}return e},t.prototype._update=function(t){this._simplex[this._n]=t,this._sort()},t.prototype._reflect=function(t,e){return this._point(i(this.rho,e,t.location))},t.prototype._expand=function(t,e){return this._point(i(this.chi,e,t.location))},t.prototype._contractInside=function(t,e){return this._point(i(this.psi,e,t.location))},t.prototype._contractOutside=function(t,e){return this._point(i(-this.psi*this.rho,e,t.location))},t.prototype._shrink=function(t,e){return this._point(i(-this.sigma,e,t.location))},t.prototype._isConverged=function(){for(var t=this._control.tolerance,e=this._simplex[0],r=this._simplex[this._n],n=r.value-e.value<t||1-e.value/r.value<t,o=0,i=0;i<this._n;++i)o=Math.max(o,Math.abs(e.location[i]-r.location[i]));return o<t&&n},t}();e.Simplex=a},3:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.checkResult=void 0,e.checkResult=function(t){return"number"==typeof t?{data:null,value:t}:t}},886:(t,e)=>{function r(t,e){return new Error("Invalid control parameter: '".concat(t,"' ").concat(e))}function n(t,e){return void 0===t?e:t}Object.defineProperty(e,"__esModule",{value:!0}),e.dopriControl=void 0,e.dopriControl=function(t){void 0===t&&(t={});var e=1e-6,o=1e4,i=1e-6,a=1/0,s=1e-8,u=!1,l=0,c=1/0,f={atol:n(t.atol,e),maxSteps:n(t.maxSteps,o),rtol:n(t.rtol,i),stepSizeMax:n(t.stepSizeMax,a),stepSizeMin:n(t.stepSizeMin,s),stepSizeMinAllow:n(t.stepSizeMinAllow,u),stiffCheck:n(t.stiffCheck,l),tcrit:n(t.tcrit,c)};if(f.maxSteps<1)throw r("maxSteps","must be at least 1");if(f.atol<=0)throw r("atol","must be strictly positive");if(f.rtol<=0)throw r("rtol","must be strictly positive");return f}},742:function(t,e,r){var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.DDE=e.integrateDDE=void 0;var i=r(223),a=r(660);e.integrateDDE=function(t,e,r,n,o,i){void 0===o&&(o={}),void 0===i&&(i=null);var a=new s(t,e.length,o,i);return a.initialise(r,e),a.run(n)};var s=function(t){function e(e,r,n,o){void 0===n&&(n={}),void 0===o&&(o=null);var i=this,a=function(t){return i._interpolate(t)},s=null===o?null:function(t,e){return o(t,e,a)};return(i=t.call(this,(function(t,r,n){return e(t,r,n,a)}),r,n,s)||this)._y0=new Array(r),i}return o(e,t),e.prototype.initialise=function(e,r){return this._y0=r,t.prototype.initialise.call(this,e,r),this},e.prototype._interpolate=function(t){var e=this._findHistory(t);return e<0?this._y0.slice(0):this._stepper.interpolate(t,this._history[e])},e.prototype._findHistory=function(t){return(0,a.search)(this._history,(function(e){return e.t>t}))},e}(i.Dopri);e.DDE=s},223:function(t,e,r){var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(e,r);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,o)}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.prototype.hasOwnProperty.call(t,r)&&n(e,t,r);return o(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Dopri=e.integrateDopri=void 0;var a=r(886),s=i(r(922)),u=r(216),l=i(r(660)),c=Math.pow(2,-52);function f(t,e){return new Error("Integration failure: ".concat(t," at ").concat(e))}e.integrateDopri=function(t,e,r,n,o,i){void 0===o&&(o={}),void 0===i&&(i=null);var a=new h(t,e.length,o,i);return a.initialise(r,e),a.run(n)};var h=function(){function t(t,e,r,n){void 0===r&&(r={}),void 0===n&&(n=null),this._history=[],this._t=0,this._h=0,this._nSteps=0,this._nStepsAccepted=0,this._nStepsRejected=0,this._stiffNStiff=0,this._stiffNNonstiff=0,this._lastError=0,this._stepper=new s.Dopri5(t,e),this._control=(0,a.dopriControl)(r),this._output=n}return t.prototype.initialise=function(t,e){var r=this._stepper.n;if(e.length!==r)throw Error("Invalid size 'y' - expected a length ".concat(r," array"));return this._stepper.reset(t,e),this._reset(),this._h=function(t,e,r,n,o,i){var a=new Array(t.n),s=new Array(t.n),u=new Array(t.n);t.rhs(e,r,a),t.nEval++;var c=0,f=0,h=0;for(h=0;h<t.n;++h){var p=n+o*Math.abs(r[h]);c+=l.square(a[h]/p),f+=l.square(r[h]/p)}var d=c<=1e-10||f<=1e-10?1e-6:.01*Math.sqrt(f/c);for(d=Math.min(d,i),h=0;h<t.n;++h)u[h]=r[h]+d*a[h];t.rhs(e+d,u,s),t.nEval++;var v=0;for(h=0;h<t.n;++h)p=n+o*Math.abs(r[h]),v+=l.square((s[h]-a[h])/p);v=Math.sqrt(v)/d;var _=Math.max(Math.abs(v),Math.sqrt(c)),y=_<=1e-15?Math.max(1e-6,.001*Math.abs(d)):Math.pow(.01/_,1/t.order);return Math.min(Math.min(100*Math.abs(d),y),i)}(this._stepper,t,e,this._control.atol,this._control.rtol,this._control.stepSizeMax),this._t=t,this._history=[],this},t.prototype.run=function(t){for(;this._t<t;)this._step(),this._history.push(this._stepper.history.clone());return(0,u.interpolator)(this._history.slice(0),this._stepper,this._output)},t.prototype.statistics=function(){return{lastError:this._lastError,nEval:this._stepper.nEval,nSteps:this._nSteps,nStepsAccepted:this._nStepsAccepted,nStepsRejected:this._nStepsRejected,stiffNNonstiff:this._stiffNNonstiff,stiffNStiff:this._stiffNStiff}},t.prototype._reset=function(){this._nSteps=0,this._nStepsAccepted=0,this._nStepsRejected=0,this._stiffNStiff=0,this._stiffNNonstiff=0,this._lastError=0},t.prototype._step=function(){for(var t=this._t,e=this._h,r=!1,n=!1,o=Math.max(this._lastError,1e-4),i=this._stepper.stepControl,a=this._control;!r;){if(this._nSteps>a.maxSteps)throw f("too many steps",t);if(e<a.stepSizeMin){if(!a.stepSizeMinAllow)throw f("step too small",t);e=a.stepSizeMin}if(e<=Math.abs(t)*c)throw f("step size vanished",t);t+e>a.tcrit&&(e=a.tcrit-t),this._stepper.step(t,e),this._nSteps++;var s=this._stepper.error(a.atol,a.rtol),u=Math.pow(s,i.constant),h=1/i.factorMin,p=1/i.factorMax;if(s<=1){if(r=!0,this._nStepsAccepted++,this._isStiff(e))throw f("problem became stiff",t);this._stepper.stepComplete(t,e);var d=u/Math.pow(o,i.beta),v=e/(d=l.constrain(d/i.factorSafe,p,h));this._t+=e,this._h=n?Math.min(v,e):Math.min(v,a.stepSizeMax),this._lastError=s}else n=!0,this._nStepsAccepted>=1&&this._nStepsRejected++,e/=Math.min(h,u/i.factorSafe)}return this._t},t.prototype._isStiff=function(t){if(this._stiffNStiff>0||this._nStepsAccepted%this._control.stiffCheck==0)if(this._stepper.isStiff(t)){if(this._stiffNNonstiff=0,this._stiffNStiff++>=15)return!0}else this._stiffNStiff>0&&this._stiffNNonstiff++>=6&&(this._stiffNStiff=0,this._stiffNNonstiff=0);return!1},t}();e.Dopri=h},167:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Dopri5StepControl=void 0;e.Dopri5StepControl=function(){this.factorSafe=.9,this.factorMin=.2,this.factorMax=10,this.beta=.04,this.constant=.2-.75*this.beta}},922:function(t,e,r){var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(e,r);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,o)}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.prototype.hasOwnProperty.call(t,r)&&n(e,t,r);return o(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Dopri5=void 0;var a=i(r(660)),s=i(r(167)),u=r(430),l=function(){function t(t,e){this.order=5,this.stepControl=new s.Dopri5StepControl,this.nEval=0,this.rhs=t,this.n=e,this.y=new Array(e),this.yNext=new Array(e),this.yStiff=new Array(e),this.k1=new Array(e),this.k2=new Array(e),this.k3=new Array(e),this.k4=new Array(e),this.k5=new Array(e),this.k6=new Array(e),this.history=new u.HistoryElement(this.order*e)}return t.prototype.step=function(t,e){var r=this.n,n=this.y,o=this.yNext,i=this.k1,a=this.k2,s=this.k3,u=this.k4,l=this.k5,c=this.k6,f=this.history.data,h=0;for(h=0;h<r;++h)o[h]=n[h]+.2*e*i[h];for(this.rhs(t+.2*e,o,a),h=0;h<r;++h)o[h]=n[h]+e*(.075*i[h]+.225*a[h]);for(this.rhs(t+.3*e,o,s),h=0;h<r;++h)o[h]=n[h]+e*(.9777777777777777*i[h]+-3.7333333333333334*a[h]+3.5555555555555554*s[h]);for(this.rhs(t+.8*e,o,u),h=0;h<r;++h)o[h]=n[h]+e*(2.9525986892242035*i[h]+-11.595793324188385*a[h]+9.822892851699436*s[h]+-.2908093278463649*u[h]);for(this.rhs(t+.8888888888888888*e,o,l),h=0;h<r;++h)this.yStiff[h]=n[h]+e*(2.8462752525252526*i[h]+-10.757575757575758*a[h]+8.906422717743473*s[h]+.2784090909090909*u[h]+-.2735313036020583*l[h]);var p=t+e;for(this.rhs(p,this.yStiff,c),h=0;h<r;++h)o[h]=n[h]+e*(.09114583333333333*i[h]+.44923629829290207*s[h]+.6510416666666666*u[h]+-.322376179245283*l[h]+.13095238095238096*c[h]);this.rhs(p,o,a);var d=4*r;for(h=0;h<r;++h)f[d++]=e*(-1.1270175653862835*i[h]+2.675424484351598*s[h]+-5.685526961588504*u[h]+3.5219323679207912*l[h]+-1.7672812570757455*c[h]+2.382468931778144*a[h]);for(h=0;h<r;++h)u[h]=e*(.0012326388888888888*i[h]+-.0042527702905061394*s[h]+.03697916666666667*u[h]+-.05086379716981132*l[h]+.0419047619047619*c[h]+-.025*a[h]);this.nEval+=6},t.prototype.stepComplete=function(t,e){this.saveHistory(t,e),a.copyArray(this.k1,this.k2),a.copyArray(this.y,this.yNext)},t.prototype.error=function(t,e){var r=0,n=0;for(n=0;n<this.n;++n){var o=t+e*Math.max(Math.abs(this.y[n]),Math.abs(this.yNext[n]));r+=a.square(this.k4[n]/o)}return Math.sqrt(r/this.n)},t.prototype.interpolate=function(t,e){for(var r=e.data,n=(t-e.t)/e.h,o=1-n,i=this.n,a=new Array(i),s=0;s<i;++s)a[s]=r[s]+n*(r[i+s]+o*(r[2*i+s]+n*(r[3*i+s]+o*r[4*i+s])));return a},t.prototype.isStiff=function(t){for(var e=0,r=0,n=0;n<this.n;++n)e+=a.square(this.k2[n]-this.k6[n]),r+=a.square(this.yNext[n]-this.yStiff[n]);return r>0&&Math.abs(t)*Math.sqrt(e/r)>3.25},t.prototype.reset=function(t,e){for(var r=0;r<this.n;++r)this.y[r]=e[r];this.rhs(t,e,this.k1),this.nEval=1},t.prototype.saveHistory=function(t,e){for(var r=this.history,n=this.n,o=0;o<n;++o){var i=this.yNext[o]-this.y[o],a=e*this.k1[o]-i;r.data[o]=this.y[o],r.data[n+o]=i,r.data[2*n+o]=a,r.data[3*n+o]=-e*this.k2[o]+i-a}r.t=t,r.h=e},t}();e.Dopri5=l},606:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.HistoryElement=void 0;var r=function(){function t(t){this.t=0,this.h=0,this.data=new Array(t)}return t.prototype.clone=function(){var e=new t(this.data.length);return e.t=this.t,e.h=this.h,e.data=this.data.slice(0),e},t}();e.HistoryElement=r},245:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.integrate=e.integrateDDE=e.DDE=e.integrateDopri=e.Dopri=void 0;var n=r(223);Object.defineProperty(e,"Dopri",{enumerable:!0,get:function(){return n.Dopri}}),Object.defineProperty(e,"integrateDopri",{enumerable:!0,get:function(){return n.integrateDopri}});var o=r(742);Object.defineProperty(e,"DDE",{enumerable:!0,get:function(){return o.DDE}}),Object.defineProperty(e,"integrateDDE",{enumerable:!0,get:function(){return o.integrateDDE}});var i=r(961);Object.defineProperty(e,"integrate",{enumerable:!0,get:function(){return i.integrate}})},961:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.integrate=void 0;var n=r(742),o=r(223);e.integrate=function(t,e,r,i,a,s){if(void 0===a&&(a={}),void 0===s&&(s=null),function(t){return 3===t.length}(t)){if(!function(t){return null===t||2===t.length}(s))throw new Error("Can't used delayed output with non-delayed rhs");return(0,o.integrateDopri)(t,e,r,i,a,s)}if(!function(t){return null===t||3===t.length}(s))throw new Error("Can't used non-delayed output with delayed rhs");return(0,n.integrateDDE)(t,e,r,i,a,s)}},216:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.interpolator=void 0,e.interpolator=function(t,e,r){return function(n){return function(t,e,r,n){for(var o=[],i=e,a=0,s=0,u=t;s<u.length;s++){for(var l=u[s];i[a].t+i[a].h<l;)a++;var c=r.interpolate(l,i[a]);null!==n&&(c=c.concat(n(l,c))),o.push(c)}return o}(n,t,e,r)}}},430:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.HistoryElement=void 0;var n=r(606);Object.defineProperty(e,"HistoryElement",{enumerable:!0,get:function(){return n.HistoryElement}})},660:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.search=e.seqLen=e.approxEqualArray=e.approxEqual=e.zeros=e.copyArray=e.constrain=e.square=void 0;var r=Math.pow(2,-26);e.square=function(t){return t*t},e.constrain=function(t,e,r){return Math.max(Math.min(t,r),e)},e.copyArray=function(t,e){for(var r=t.length,n=0;n<r;n++)t[n]=e[n]},e.zeros=function(t){for(var e=Array(t),r=0;r<t;++r)e[r]=0;return e},e.approxEqual=function(t,e,n){void 0===n&&(n=r);var o=Math.abs(t-e),i=Math.abs(t);return i>n&&(o/=i),o<n},e.approxEqualArray=function(t,e,n){if(void 0===n&&(n=r),e.length!==t.length)throw Error("Incompatible arrays");for(var o=0,i=0,a=0,s=0;s<t.length;++s)t[s]!==e[s]&&(o+=Math.abs(t[s]),i+=Math.abs(t[s]-e[s]),a++);return 0===a||(i/=a,(o/=a)>n&&(i/=o),i<n)},e.seqLen=function(t,e,r){for(var n=[],o=0;o<r;++o){var i=o/(r-1);n.push((1-i)*t+i*e)}return n},e.search=function(t,e){var r=0,n=t.length-1;if(0===t.length||e(t[r]))return-1;if(!e(t[n]))return n;for(;n-r>1;){var o=Math.floor((r+n)/2);e(t[o])?n=o:r=o}return r}},863:t=>{t.exports=function(t,e,r,n,o){var i,a;for(i=1;i<t;i++){if(0===r[i-1])return console.log("tridiagonalSolve: failed due to lack of diagonal dominance"),!1;a=e[i]/r[i-1],r[i]-=a*n[i-1],o[i]-=a*o[i-1]}if(0===r[t-1])return console.log("tridiagonalSolve: failed due to singular matrix"),!1;for(o[t-1]/=r[t-1],i=t-2;i>=0;i--){if(0===r[i])return console.log("tridiagonalSolve: failed due to singular matrix"),!1;o[i]=(o[i]-n[i]*o[i+1])/r[i]}return!0}},653:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.base=void 0;const n=r(458),o=r(166),i=r(650),a=r(536);e.base={delay:n.delay,interpolate:o.interpolate,maths:i.maths,user:a.user}},401:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.updatePars=e.batchParsDisplace=e.batchParsRange=e.batchRun=e.Batch=void 0;const n=r(822),o=r(882),i=r(915);class a{constructor(t,e,r,n,o){this.pars=e,this.tStart=r,this.tEnd=n,this.solutions=e.values.map((a=>{const s=u(e.base,e.name,a);return(0,i.wodinRun)(t,s,r,n,o)}))}valueAtTime(t){const e=this.solutions.map((e=>e({mode:n.TimeMode.Given,times:[t]})));return{names:e[0].names,x:this.pars.values,y:e[0].names.map(((t,r)=>e.map((t=>t.y[r][0]))))}}extreme(t){return this.findExtremes()[t]}findExtremes(){if(void 0===this._extremes){const t=501,e={mode:n.TimeMode.Grid,nPoints:t,tEnd:this.tEnd,tStart:this.tStart},r=this.solutions.map((t=>t(e))),i=r[0].names,a=this.pars.values,s=(0,o.loop)(i.length,(t=>r.map((e=>function(t,e){const r=e.x,n=e.y[t],i=(0,o.whichMin)(n),a=(0,o.whichMax)(n),s=r[i],u=r[a],l=n[i];return{tMax:u,tMin:s,yMax:n[a],yMin:l}}(t,e)))));this._extremes={tMax:c("tMax",i,a,s),tMin:c("tMin",i,a,s),yMax:c("yMax",i,a,s),yMin:c("yMin",i,a,s)}}return this._extremes}}function s(t,e,r,n,i,a){const s=l(t,e);if(i>s)throw Error(`Expected lower bound to be no greater than ${s}`);if(a<s)throw Error(`Expected upper bound to be no less than ${s}`);if(i>=a)throw Error("Expected upper bound to be greater than lower bound");if(r<2)throw Error("Must include at least 2 traces in the batch");if(n&&i<=0)throw Error("Lower bound must be greater than 0 for logarithmic scale");return{base:t,name:e,values:n?(0,o.gridLog)(i,a,r):(0,o.grid)(i,a,r)}}function u(t,e,r){const n=Object.assign({},t);return n[e]=r,n}function l(t,e){const r=t[e];if(void 0===r)throw Error(`Expected a value for '${e}'`);if("number"!=typeof r)throw Error(`Expected a number for '${e}'`);return r}function c(t,e,r,n){return{names:e,x:r,y:(0,o.loop)(e.length,(e=>n[e].map((e=>e[t]))))}}e.Batch=a,e.batchRun=function(t,e,r,n,o){return new a(t,e,r,n,o)},e.batchParsRange=s,e.batchParsDisplace=function(t,e,r,n,o){const i=l(t,e),a=o/100;return s(t,e,r,n,i*(1-a),i*(1+a))},e.updatePars=u},458:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.delay=void 0,e.delay=function(t,e,r,n){const o=t(e);for(let t=0;t<r.length;++t)n[t]=o[r[t]]}},410:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.sumOfSquares=e.updatePars=e.fitTarget=void 0;const n=r(653),o=r(134),i=r(822);function a(t,e){const r=Object.assign({},t.base);for(let n=0;n<t.vary.length;++n)r[t.vary[n]]=e[n];return r}function s(t,e){let r=0;for(let n=0;n<t.length;++n){const o=t[n];isNaN(o)||(r+=Math.pow(o-e[n],2))}return r}e.fitTarget=function(t,e,r,u,l){if(e.time[0]<0)throw Error("Expected the first time to be at least 0");const c=e.time[e.time.length-1];return f=>{const h=a(r,f),p=new t(n.base,h,"error"),d=(0,o.runModel)(p,null,0,c,l).solution,v=p.names(),_=v.indexOf(u),y=d(e.time).map((t=>t[_]));return{data:{endTime:c,names:v,pars:h,solution:(0,i.interpolatedSolution)(d,v,0,c),startTime:0},value:s(e.value,y)}}},e.updatePars=a,e.sumOfSquares=s},166:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.interpolate=e.interpolateTimes=e.interpolateCheckT=e.interpolateCheckY=e.interpolateAlloc=void 0;const n=r(673);function o(t,e,r){const o=function(t,e){if(t.length===e)return[t];const r=[],n=t.length/e;for(let o=0;o<n;++o)r.push(t.slice(e*o,e*(o+1)));return r}(r,e.length);if("constant"===t)return new n.InterpolatorConstant(e,o);if("linear"===t)return new n.InterpolatorLinear(e,o);if("spline"===t)return new n.InterpolatorSpline(e,o);throw Error(`Invalid interpolation method '${t}'`)}function i(t,e,r,n){if(1===e.length){if(t[0]!==e[0])throw Error(`Expected ${r} to have length ${t[0]} (for ${n})`)}else for(let o=0;o<e.length;++o)if(t[o]!==e[o])throw Error(`Expected dimension ${o+1} of ${r} to have size ${t[o]} (for ${n})`)}function a(t,e){const r=Math.max(...t);return{max:Math.min(...e),min:r}}e.interpolateAlloc=o,e.interpolateCheckY=i,e.interpolateCheckT=function(t,e,r,n){if(void 0===r)return 1/0;if(t<r.min)throw Error(`Integration times do not span interpolation range; min: ${r.min}`);if(e>r.max)throw Error(`Integration times do not span interpolation range; max: ${r.max}`);return void 0===n&&(n=r.max),n},e.interpolateTimes=a,e.interpolate={alloc:o,checkY:i,times:a}},650:(t,e)=>{function r(t){return.5===o(t,1)?2*Math.round(t/2):Math.round(t)}function n(t,e){if(void 0===e||0===e)return r(t);{const n=Math.pow(10,e);return r(t*n)/n}}function o(t,e){let r=t%e;return r*e<0&&(r+=e),r}function i(t,e){return Math.floor(t/e)}function a(t,e,r){let n=0;for(let o=e;o<r;++o)n+=t[o];return n}function s(t,e,r,n,o,i){let a=0;for(let s=n;s<o;++s){const n=s*i;for(let o=e;o<r;++o)a+=t[o+n]}return a}function u(t,e,r,n,o,i,a,s,u){let l=0;for(let c=i;c<a;++c){const i=c*u;for(let a=n;a<o;++a){const n=a*s+i;for(let o=e;o<r;++o)l+=t[o+n]}}return l}Object.defineProperty(e,"__esModule",{value:!0}),e.maths=e.odinSum3=e.odinSum2=e.odinSum1=e.intdivr=e.modr=e.round2=void 0,e.round2=n,e.modr=o,e.intdivr=i,e.odinSum1=a,e.odinSum2=s,e.odinSum3=u,e.maths={intdivr:i,modr:o,odinSum1:a,odinSum2:s,odinSum3:u,round2:n}},134:function(t,e,r){var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(e,r);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,o)}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.prototype.hasOwnProperty.call(t,r)&&n(e,t,r);return o(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.runModel=e.isODEModel=e.isDDEModel=void 0;const a=i(r(245)),s=r(166);function u(t){return 4===t.rhs.length}e.isDDEModel=u,e.isODEModel=function(t){return 3===t.rhs.length},e.runModel=function(t,e,r,n,o){const i=t.getMetadata().interpolateTimes;return o.tcrit=(0,s.interpolateCheckT)(r,n,i,o.tcrit),u(t)?function(t,e,r,n,o){let i=null;"function"==typeof t.output&&(i=(e,r,n)=>t.output(e,r,n)),null===e&&(e=t.initial(r)),t.getInternal().initial_t=r;const s=new a.DDE((function(e,r,n,o){t.rhs(e,r,n,o)}),e.length,o,i);return s.initialise(r,e),{solution:s.run(n),statistics:s.statistics()}}(t,e,r,n,o):function(t,e,r,n,o){let i=null;"function"==typeof t.output&&(i=(e,r)=>t.output(e,r)),null===e&&(e=t.initial(r));const s=new a.Dopri((function(e,r,n){t.rhs(e,r,n)}),e.length,o,i);return s.initialise(r,e),{solution:s.run(n),statistics:s.statistics()}}(t,e,r,n,o)}},586:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PkgWrapper=void 0;const n=r(653),o=r(134);e.PkgWrapper=class{constructor(t,e,r){this.model=new t(n.base,e,r)}initial(t){return this.model.initial(t)}rhs(t,e){const r=new Array(e.length).fill(0);let n=null;if(!(0,o.isODEModel)(this.model))throw Error("Can't use rhs() with delay models");return this.model,this.model.rhs(t,e,r),this.model.output&&(n=this.model.output(t,e)),{output:n,state:r}}getMetadata(){return this.model.getMetadata()}getInternal(){return this.model.getInternal()}setUser(t,e){this.model.setUser(t,e)}run(t,e,r){const n=t[0],i=t[t.length-1],a=(0,o.runModel)(this.model,e,n,i,r);return{names:this.model.names(),statistics:a.statistics,y:a.solution(t)}}}},822:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.interpolatedSolution=e.TimeMode=void 0;const n=r(882);var o;!function(t){t.Grid="grid",t.Given="given"}(o=e.TimeMode||(e.TimeMode={})),e.interpolatedSolution=function(t,e,r,i){return a=>{const s=function(t,e,r){switch(t.mode){case o.Grid:return(0,n.grid)(Math.max(e,t.tStart),Math.min(r,t.tEnd),t.nPoints);case o.Given:return t.times}}(a,r,i),u=t(s),l=u[0].map(((t,e)=>u.map((t=>t[e]))));return{names:e,x:s,y:l}}}},536:(t,e)=>{function r(t,e,r){if("ignore"===r)return;const n=[];for(const r of Object.keys(t))e.includes(r)||n.push(r);if(n.length>0){const t="Unknown user parameters: "+n.join(", ");if("message"===r)console.log(t);else{if("warning"!==r)throw"stop"===r?Error(t):Error(t+" (and invalid value for unusedUserAction)");console.warn(t)}}}function n(t,e,r,n,o,i,a){const s=t[e];if(void 0===s){if(void 0!==r[e])return;if(null===n)throw Error(`Expected a value for '${e}'`);r[e]=n}else{if("number"!=typeof s)throw Error(`Expected a number for '${e}'`);l(s,o,i,a,e),r[e]=s}}function o(t,e,r,n,o,i,l){let c=t[e];if(void 0===c){if(void 0!==r[e])return;throw Error(`Expected a value for '${e}'`)}{const t=n.length-1;c=a(c),s(t,c,e),function(t,e,r){const n=t.length-1;for(let o=0;o<n;++o){const i=t[o+1];if(e.dim[o]!==i)throw 1===n?Error(`Expected length ${i} value for '${r}'`):Error(`Incorrect size of dimension ${o+1} of '${r}' (expected ${i})`)}}(n,c,e),u(c,o,i,l,e),r[e]=c.data.slice()}}function i(t,e,r,n,o,i,l){let c=t[e];if(void 0===c){if(void 0!==r[e])return;throw Error("Expected a value for '"+e+"'")}{const t=n.length-1;c=a(c),s(t,c,e),u(c,o,i,l,e),n[0]=c.data.length;for(let e=0;e<t;++e)n[e+1]=c.dim[e];r[e]=c.data.slice()}}function a(t,e){return Array.isArray(t)?t={data:t,dim:[t.length]}:"number"==typeof t&&(t={data:[t],dim:[1]}),t}function s(t,e,r){if(e.dim.length!==t)throw 1===t?Error(`Expected a numeric vector for '${r}'`):2===t?Error(`Expected a numeric matrix for '${r}'`):Error(`Expected a numeric array of rank ${t} for '${r}'`)}function u(t,e,r,n,o){for(const i of t.data){if(null===i)throw Error(`'${o}' must not contain any NA values`);l(i,e,r,n,o)}}function l(t,e,r,n,o){if("number"!=typeof t)throw Error(`Expected a number for '${o}'`);if(t<e)throw Error(`Expected '${o}' to be at least ${e}`);if(t>r)throw Error(`Expected '${o}' to be at most ${r}`);if(n&&!Number.isInteger(t))throw Error(`Expected '${o}' to be integer-like`)}Object.defineProperty(e,"__esModule",{value:!0}),e.user=e.setUserArrayVariable=e.setUserArrayFixed=e.setUserScalar=e.checkUser=void 0,e.checkUser=r,e.setUserScalar=n,e.setUserArrayFixed=o,e.setUserArrayVariable=i,e.user={checkUser:r,setUserArrayFixed:o,setUserArrayVariable:i,setUserScalar:n}},882:(t,e)=>{function r(t,e,r){const n=(e-t)/(r-1),o=[];for(let e=0;e<r-1;++e)o.push(t+e*n);return o.push(e),o}Object.defineProperty(e,"__esModule",{value:!0}),e.loop=e.whichMax=e.whichMin=e.gridLog=e.grid=void 0,e.grid=r,e.gridLog=function(t,e,n){return r(Math.log(t),Math.log(e),n).map(Math.exp)},e.whichMin=function(t){let e=-1,r=1/0;for(let n=0;n<t.length;++n)t[n]<r&&(e=n,r=t[n]);return e},e.whichMax=function(t){let e=-1,r=-1/0;for(let n=0;n<t.length;++n)t[n]>r&&(e=n,r=t[n]);return e},e.loop=function(t,e){const r=[];for(let n=0;n<t;++n)r.push(e(n));return r}},556:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.versions=void 0,e.versions=function(){return{dfoptim:"0.0.5",dopri:"0.0.12",odinjs:"0.0.15"}}},915:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.wodinFitValue=e.wodinFit=e.wodinRun=void 0;const n=r(153),o=r(653),i=r(410),a=r(134),s=r(822);e.wodinRun=function(t,e,r,n,i){const u=new t(o.base,e,"error"),l=(0,a.runModel)(u,null,r,n,i).solution,c=u.names();return(0,s.interpolatedSolution)(l,c,r,n)},e.wodinFit=function(t,e,r,o,a,s){const u=(0,i.fitTarget)(t,e,r,o,a),l=r.vary.map((t=>r.base[t]));return new n.Simplex(u,l,s)},e.wodinFitValue=function(t,e,r){const{names:n,y:o}=t({mode:s.TimeMode.Given,times:e.time}),a=n.indexOf(r);return(0,i.sumOfSquares)(e.value,o[a])}}},e={};function r(n){var o=e[n];if(void 0!==o)return o.exports;var i=e[n]={exports:{}};return t[n].call(i.exports,i,i.exports,r),i.exports}var n={};(()=>{var t=n;Object.defineProperty(t,"__esModule",{value:!0}),t.versions=t.batchRun=t.batchParsRange=t.batchParsDisplace=t.Batch=t.base=t.PkgWrapper=t.wodinRun=t.wodinFitValue=t.wodinFit=void 0;var e=r(915);Object.defineProperty(t,"wodinFit",{enumerable:!0,get:function(){return e.wodinFit}}),Object.defineProperty(t,"wodinFitValue",{enumerable:!0,get:function(){return e.wodinFitValue}}),Object.defineProperty(t,"wodinRun",{enumerable:!0,get:function(){return e.wodinRun}});var o=r(586);Object.defineProperty(t,"PkgWrapper",{enumerable:!0,get:function(){return o.PkgWrapper}});var i=r(653);Object.defineProperty(t,"base",{enumerable:!0,get:function(){return i.base}});var a=r(401);Object.defineProperty(t,"Batch",{enumerable:!0,get:function(){return a.Batch}}),Object.defineProperty(t,"batchParsDisplace",{enumerable:!0,get:function(){return a.batchParsDisplace}}),Object.defineProperty(t,"batchParsRange",{enumerable:!0,get:function(){return a.batchParsRange}}),Object.defineProperty(t,"batchRun",{enumerable:!0,get:function(){return a.batchRun}});var s=r(556);Object.defineProperty(t,"versions",{enumerable:!0,get:function(){return s.versions}})})(),odinjs=n})();
