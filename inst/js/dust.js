/*! For license information please see dust.js.LICENSE.txt */
var dust;(()=>{var t={6:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.interpolateSearch=e.InterpolatorBase=void 0;var r=function(){function t(t,e){(function(t){return Array.isArray(t[0])})(e)||(e=[e]),this._i=0,this._x=t,this._y=e,this.nX=this._x.length,this.nY=this._y.length;for(var r=0;r<this.nY;++r)if(this._y[r].length!==this.nX)throw Error("Invalid length for 'y', expected ".concat(this.nX))}return t.prototype.evalAll=function(t){for(var e=Array(this.nY),r=0;r<this.nY;++r)e[r]=this.eval(t,r);return e},t.prototype.search=function(t,e){var r=n(t,this._x,this._i);if(r<0||!e&&r===this.nX)throw Error("Interpolation failed as 'x' is out of range");return this._i=r,r},t}();function n(t,e,r){var n=r,i=r,o=1,s=e.length;if(e[n]<=t){if(n>=s-1)return s;for(i=n+o;e[i]<t;)if(n=i,(i+=o*=2)>=s){if(e[i=s-1]<t)return s;break}}else{if(0===n)return-1;for(n-=o;e[n]>t;){if(i=n,n<(o*=2)){if(e[n=0]>t)return-1;break}n-=o}}for(;i-n>1;){var a=Math.floor((i+n)/2);e[a]<t?n=a:i=a}return n}e.InterpolatorBase=r,e.interpolateSearch=n},731:function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.InterpolatorConstant=void 0;var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.eval=function(t,e){void 0===e&&(e=0);var r=Math.min(this.search(t,!0),this.nX-1);return r!==this.nX-1&&this._x[r+1]===t&&++r,this._y[e][r]},e}(r(6).InterpolatorBase);e.InterpolatorConstant=o},673:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.InterpolatorSpline=e.InterpolatorLinear=e.InterpolatorConstant=e.InterpolatorBase=void 0;var n=r(6);Object.defineProperty(e,"InterpolatorBase",{enumerable:!0,get:function(){return n.InterpolatorBase}});var i=r(731);Object.defineProperty(e,"InterpolatorConstant",{enumerable:!0,get:function(){return i.InterpolatorConstant}});var o=r(477);Object.defineProperty(e,"InterpolatorLinear",{enumerable:!0,get:function(){return o.InterpolatorLinear}});var s=r(869);Object.defineProperty(e,"InterpolatorSpline",{enumerable:!0,get:function(){return s.InterpolatorSpline}})},477:function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.InterpolatorLinear=void 0;var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.eval=function(t,e){void 0===e&&(e=0);var r=this.search(t,!1),n=this._x[r],i=(t-n)/(this._x[r+1]-n),o=this._y[e],s=o[r];return s+(o[r+1]-s)*i},e}(r(6).InterpolatorBase);e.InterpolatorLinear=o},869:function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.solve=e.InterpolatorSpline=void 0;var s=o(r(863)),a=function(t){function e(e,r){var n=t.call(this,e,r)||this,i=function(t){var e=t.length,r=Array(e),n=Array(e),i=Array(e);r[0]=0,n[0]=2/(t[1]-t[0]),i[0]=1/(t[1]-t[0]);for(var o=1;o<e-1;++o){var s=t[o-1],a=t[o],u=t[o+1];r[o]=1/(a-s),n[o]=2*(1/(a-s)+1/(u-a)),i[o]=1/(u-a)}return r[e-1]=1/(t[e-1]-t[e-2]),n[e-1]=2/(t[e-1]-t[e-2]),i[e-1]=0,[r,n,i]}(n._x),o=function(t,e){for(var r=t.length,n=e.length,i=r-1,o=[],s=0;s<n;++s){var a=Array(r),u=e[s];a[0]=3*(u[1]-u[0])/Math.pow(t[1]-t[0],2);for(var c=1;c<i;++c){var l=t[c-1],f=t[c],h=t[c+1],p=u[c-1],d=u[c],v=u[c+1];a[c]=3*((d-p)/Math.pow(f-l,2)+(v-d)/Math.pow(h-f,2))}a[i]=3*(u[i]-u[i-1])/Math.pow(t[i]-t[i-1],2),o.push(a)}return o}(n._x,n._y);return n._k=function(t,e){for(var r=t[0],n=t[1],i=t[2],o=r.length,s=0,a=e;s<a.length;s++){var c=a[s];u(o,r,n.slice(),i,c)}return e}(i,o),n}return i(e,t),e.prototype.eval=function(t,e){void 0===e&&(e=0);var r=this.search(t,!1);return Array(this.nY),function(t,e,r,n,i){var o=(e-r[t])/(r[t+1]-r[t]),s=i[t]*(r[t+1]-r[t])-(n[t+1]-n[t]),a=-i[t+1]*(r[t+1]-r[t])+(n[t+1]-n[t]);return(1-o)*n[t]+o*n[t+1]+o*(1-o)*(s*(1-o)+a*o)}(r,t,this._x,this._y[e],this._k[e])},e}(r(6).InterpolatorBase);function u(t,e,r,n,i){if(!(0,s.default)(t,e,r,n,i))throw Error("solve failed: singular matrix?")}e.InterpolatorSpline=a,e.solve=u},251:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.base=void 0;const n=r(350),i=r(320),o=r(928),s=r(630);e.base={delay:n.delay,interpolate:i.interpolate,maths:o.maths,user:s.user}},601:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.updatePars=e.batchParsDisplace=e.batchParsRange=e.batchRun=e.Batch=void 0;const n=r(46),i=r(729),o=r(466);class s{constructor(t,e,r,n,i){this.pars=e,this.tStart=r,this.tEnd=n,this.solutions=e.values.map((s=>{const a=u(e.base,e.name,s);return(0,o.wodinRun)(t,a,r,n,i)}))}valueAtTime(t){const e=this.solutions.map((e=>e({mode:n.TimeMode.Given,times:[t]})));return{names:e[0].names,x:this.pars.values,y:e[0].names.map(((t,r)=>e.map((t=>t.y[r][0]))))}}extreme(t){return this.findExtremes()[t]}findExtremes(){if(void 0===this._extremes){const t=501,e={mode:n.TimeMode.Grid,nPoints:t,tEnd:this.tEnd,tStart:this.tStart},r=this.solutions.map((t=>t(e))),o=r[0].names,s=this.pars.values,a=(0,i.loop)(o.length,(t=>r.map((e=>function(t,e){const r=e.x,n=e.y[t],o=(0,i.whichMin)(n),s=(0,i.whichMax)(n),a=r[o],u=r[s],c=n[o];return{tMax:u,tMin:a,yMax:n[s],yMin:c}}(t,e)))));this._extremes={tMax:l("tMax",o,s,a),tMin:l("tMin",o,s,a),yMax:l("yMax",o,s,a),yMin:l("yMin",o,s,a)}}return this._extremes}}function a(t,e,r,n,o,s){const a=c(t,e);if(o>a)throw Error(`Expected lower bound to be no greater than ${a}`);if(s<a)throw Error(`Expected upper bound to be no less than ${a}`);if(o>=s)throw Error("Expected upper bound to be greater than lower bound");if(r<2)throw Error("Must include at least 2 traces in the batch");if(n&&o<=0)throw Error("Lower bound must be greater than 0 for logarithmic scale");return{base:t,name:e,values:n?(0,i.gridLog)(o,s,r):(0,i.grid)(o,s,r)}}function u(t,e,r){const n=Object.assign({},t);return n[e]=r,n}function c(t,e){const r=t[e];if(void 0===r)throw Error(`Expected a value for '${e}'`);if("number"!=typeof r)throw Error(`Expected a number for '${e}'`);return r}function l(t,e,r,n){return{names:e,x:r,y:(0,i.loop)(e.length,(e=>n[e].map((e=>e[t]))))}}e.Batch=s,e.batchRun=function(t,e,r,n,i){return new s(t,e,r,n,i)},e.batchParsRange=a,e.batchParsDisplace=function(t,e,r,n,i){const o=c(t,e),s=i/100;return a(t,e,r,n,o*(1-s),o*(1+s))},e.updatePars=u},350:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.delay=void 0,e.delay=function(t,e,r,n){const i=t(e);for(let t=0;t<r.length;++t)n[t]=i[r[t]]}},771:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.sumOfSquares=e.updatePars=e.fitTarget=void 0;const n=r(251),i=r(267),o=r(46);function s(t,e){const r=Object.assign({},t.base);for(let n=0;n<t.vary.length;++n)r[t.vary[n]]=e[n];return r}function a(t,e){let r=0;for(let n=0;n<t.length;++n){const i=t[n];isNaN(i)||(r+=Math.pow(i-e[n],2))}return r}e.fitTarget=function(t,e,r,u,c){if(e.time[0]<0)throw Error("Expected the first time to be at least 0");const l=e.time[e.time.length-1];return f=>{const h=s(r,f),p=new t(n.base,h,"error"),d=(0,i.runModel)(p,null,0,l,c).solution,v=p.names(),y=v.indexOf(u),_=d(e.time).map((t=>t[y]));return{data:{endTime:l,names:v,pars:h,solution:(0,o.interpolatedSolution)(d,v,0,l),startTime:0},value:a(e.value,_)}}},e.updatePars=s,e.sumOfSquares=a},688:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.versions=e.batchRun=e.batchParsRange=e.batchParsDisplace=e.Batch=e.base=e.PkgWrapper=e.wodinRun=e.wodinFitValue=e.wodinFit=void 0;var n=r(466);Object.defineProperty(e,"wodinFit",{enumerable:!0,get:function(){return n.wodinFit}}),Object.defineProperty(e,"wodinFitValue",{enumerable:!0,get:function(){return n.wodinFitValue}}),Object.defineProperty(e,"wodinRun",{enumerable:!0,get:function(){return n.wodinRun}});var i=r(714);Object.defineProperty(e,"PkgWrapper",{enumerable:!0,get:function(){return i.PkgWrapper}});var o=r(251);Object.defineProperty(e,"base",{enumerable:!0,get:function(){return o.base}});var s=r(601);Object.defineProperty(e,"Batch",{enumerable:!0,get:function(){return s.Batch}}),Object.defineProperty(e,"batchParsDisplace",{enumerable:!0,get:function(){return s.batchParsDisplace}}),Object.defineProperty(e,"batchParsRange",{enumerable:!0,get:function(){return s.batchParsRange}}),Object.defineProperty(e,"batchRun",{enumerable:!0,get:function(){return s.batchRun}});var a=r(497);Object.defineProperty(e,"versions",{enumerable:!0,get:function(){return a.versions}})},320:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.interpolate=e.interpolateTimes=e.interpolateCheckT=e.interpolateCheckY=e.interpolateAlloc=void 0;const n=r(673);function i(t,e,r){const i=function(t,e){if(t.length===e)return[t];const r=[],n=t.length/e;for(let i=0;i<n;++i)r.push(t.slice(e*i,e*(i+1)));return r}(r,e.length);if("constant"===t)return new n.InterpolatorConstant(e,i);if("linear"===t)return new n.InterpolatorLinear(e,i);if("spline"===t)return new n.InterpolatorSpline(e,i);throw Error(`Invalid interpolation method '${t}'`)}function o(t,e,r,n){if(1===e.length){if(t[0]!==e[0])throw Error(`Expected ${r} to have length ${t[0]} (for ${n})`)}else for(let i=0;i<e.length;++i)if(t[i]!==e[i])throw Error(`Expected dimension ${i+1} of ${r} to have size ${t[i]} (for ${n})`)}function s(t,e){const r=Math.max(...t);return{max:Math.min(...e),min:r}}e.interpolateAlloc=i,e.interpolateCheckY=o,e.interpolateCheckT=function(t,e,r,n){if(void 0===r)return 1/0;if(t<r.min)throw Error(`Integration times do not span interpolation range; min: ${r.min}`);if(e>r.max)throw Error(`Integration times do not span interpolation range; max: ${r.max}`);return void 0===n&&(n=r.max),n},e.interpolateTimes=s,e.interpolate={alloc:i,checkY:o,times:s}},928:(t,e)=>{"use strict";function r(t){return.5===i(t,1)?2*Math.round(t/2):Math.round(t)}function n(t,e){if(void 0===e||0===e)return r(t);{const n=Math.pow(10,e);return r(t*n)/n}}function i(t,e){let r=t%e;return r*e<0&&(r+=e),r}function o(t,e){return Math.floor(t/e)}function s(t,e,r){let n=0;for(let i=e;i<r;++i)n+=t[i];return n}function a(t,e,r,n,i,o){let s=0;for(let a=n;a<i;++a){const n=a*o;for(let i=e;i<r;++i)s+=t[i+n]}return s}function u(t,e,r,n,i,o,s,a,u){let c=0;for(let l=o;l<s;++l){const o=l*u;for(let s=n;s<i;++s){const n=s*a+o;for(let i=e;i<r;++i)c+=t[i+n]}}return c}Object.defineProperty(e,"__esModule",{value:!0}),e.maths=e.odinSum3=e.odinSum2=e.odinSum1=e.intdivr=e.modr=e.round2=void 0,e.round2=n,e.modr=i,e.intdivr=o,e.odinSum1=s,e.odinSum2=a,e.odinSum3=u,e.maths={intdivr:o,modr:i,odinSum1:s,odinSum2:a,odinSum3:u,round2:n}},267:function(t,e,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);i&&!("get"in i?!e.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.prototype.hasOwnProperty.call(t,r)&&n(e,t,r);return i(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.runModel=e.isODEModel=e.isDDEModel=void 0;const s=o(r(245)),a=r(320);function u(t){return 4===t.rhs.length}e.isDDEModel=u,e.isODEModel=function(t){return 3===t.rhs.length},e.runModel=function(t,e,r,n,i){const o=t.getMetadata().interpolateTimes;return i.tcrit=(0,a.interpolateCheckT)(r,n,o,i.tcrit),u(t)?function(t,e,r,n,i){let o=null;"function"==typeof t.output&&(o=(e,r,n)=>t.output(e,r,n)),null===e&&(e=t.initial(r)),t.getInternal().initial_t=r;const a=new s.DDE((function(e,r,n,i){t.rhs(e,r,n,i)}),e.length,i,o);return a.initialise(r,e),{solution:a.run(n),statistics:a.statistics()}}(t,e,r,n,i):function(t,e,r,n,i){let o=null;"function"==typeof t.output&&(o=(e,r)=>t.output(e,r)),null===e&&(e=t.initial(r));const a=new s.Dopri((function(e,r,n){t.rhs(e,r,n)}),e.length,i,o);return a.initialise(r,e),{solution:a.run(n),statistics:a.statistics()}}(t,e,r,n,i)}},714:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PkgWrapper=void 0;const n=r(251),i=r(267);e.PkgWrapper=class{constructor(t,e,r){this.model=new t(n.base,e,r)}initial(t){return this.model.initial(t)}rhs(t,e){const r=new Array(e.length).fill(0);let n=null;if(!(0,i.isODEModel)(this.model))throw Error("Can't use rhs() with delay models");return this.model,this.model.rhs(t,e,r),this.model.output&&(n=this.model.output(t,e)),{output:n,state:r}}getMetadata(){return this.model.getMetadata()}getInternal(){return this.model.getInternal()}setUser(t,e){this.model.setUser(t,e)}run(t,e,r){const n=t[0],o=t[t.length-1],s=(0,i.runModel)(this.model,e,n,o,r);return{names:this.model.names(),statistics:s.statistics,y:s.solution(t)}}}},46:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.interpolatedSolution=e.TimeMode=void 0;const n=r(729);var i;!function(t){t.Grid="grid",t.Given="given"}(i=e.TimeMode||(e.TimeMode={})),e.interpolatedSolution=function(t,e,r,o){return s=>{const a=function(t,e,r){switch(t.mode){case i.Grid:return(0,n.grid)(Math.max(e,t.tStart),Math.min(r,t.tEnd),t.nPoints);case i.Given:return t.times}}(s,r,o),u=t(a),c=u[0].map(((t,e)=>u.map((t=>t[e]))));return{names:e,x:a,y:c}}}},630:(t,e)=>{"use strict";function r(t,e,r){if("ignore"===r)return;const n=[];for(const r of Object.keys(t))e.includes(r)||n.push(r);if(n.length>0){const t="Unknown user parameters: "+n.join(", ");if("message"===r)console.log(t);else{if("warning"!==r)throw"stop"===r?Error(t):Error(t+" (and invalid value for unusedUserAction)");console.warn(t)}}}function n(t,e,r,n,i,o,s){const a=t[e];if(void 0===a){if(void 0!==r[e])return;if(null===n)throw Error(`Expected a value for '${e}'`);r[e]=n}else{if("number"!=typeof a)throw Error(`Expected a number for '${e}'`);c(a,i,o,s,e),r[e]=a}}function i(t,e,r,n,i,o,c){let l=t[e];if(void 0===l){if(void 0!==r[e])return;throw Error(`Expected a value for '${e}'`)}{const t=n.length-1;l=s(l),a(t,l,e),function(t,e,r){const n=t.length-1;for(let i=0;i<n;++i){const o=t[i+1];if(e.dim[i]!==o)throw 1===n?Error(`Expected length ${o} value for '${r}'`):Error(`Incorrect size of dimension ${i+1} of '${r}' (expected ${o})`)}}(n,l,e),u(l,i,o,c,e),r[e]=l.data.slice()}}function o(t,e,r,n,i,o,c){let l=t[e];if(void 0===l){if(void 0!==r[e])return;throw Error("Expected a value for '"+e+"'")}{const t=n.length-1;l=s(l),a(t,l,e),u(l,i,o,c,e),n[0]=l.data.length;for(let e=0;e<t;++e)n[e+1]=l.dim[e];r[e]=l.data.slice()}}function s(t,e){return Array.isArray(t)?t={data:t,dim:[t.length]}:"number"==typeof t&&(t={data:[t],dim:[1]}),t}function a(t,e,r){if(e.dim.length!==t)throw 1===t?Error(`Expected a numeric vector for '${r}'`):2===t?Error(`Expected a numeric matrix for '${r}'`):Error(`Expected a numeric array of rank ${t} for '${r}'`)}function u(t,e,r,n,i){for(const o of t.data){if(null===o)throw Error(`'${i}' must not contain any NA values`);c(o,e,r,n,i)}}function c(t,e,r,n,i){if("number"!=typeof t)throw Error(`Expected a number for '${i}'`);if(t<e)throw Error(`Expected '${i}' to be at least ${e}`);if(t>r)throw Error(`Expected '${i}' to be at most ${r}`);if(n&&!Number.isInteger(t))throw Error(`Expected '${i}' to be integer-like`)}Object.defineProperty(e,"__esModule",{value:!0}),e.user=e.setUserArrayVariable=e.setUserArrayFixed=e.setUserScalar=e.checkUser=void 0,e.checkUser=r,e.setUserScalar=n,e.setUserArrayFixed=i,e.setUserArrayVariable=o,e.user={checkUser:r,setUserArrayFixed:i,setUserArrayVariable:o,setUserScalar:n}},729:(t,e)=>{"use strict";function r(t,e,r){const n=(e-t)/(r-1),i=[];for(let e=0;e<r-1;++e)i.push(t+e*n);return i.push(e),i}Object.defineProperty(e,"__esModule",{value:!0}),e.loop=e.whichMax=e.whichMin=e.gridLog=e.grid=void 0,e.grid=r,e.gridLog=function(t,e,n){return r(Math.log(t),Math.log(e),n).map(Math.exp)},e.whichMin=function(t){let e=-1,r=1/0;for(let n=0;n<t.length;++n)t[n]<r&&(e=n,r=t[n]);return e},e.whichMax=function(t){let e=-1,r=-1/0;for(let n=0;n<t.length;++n)t[n]>r&&(e=n,r=t[n]);return e},e.loop=function(t,e){const r=[];for(let n=0;n<t;++n)r.push(e(n));return r}},497:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.versions=void 0,e.versions=function(){return{dfoptim:"0.0.5",dopri:"0.0.12",odinjs:"0.0.15"}}},466:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.wodinFitValue=e.wodinFit=e.wodinRun=void 0;const n=r(153),i=r(251),o=r(771),s=r(267),a=r(46);e.wodinRun=function(t,e,r,n,o){const u=new t(i.base,e,"error"),c=(0,s.runModel)(u,null,r,n,o).solution,l=u.names();return(0,a.interpolatedSolution)(c,l,r,n)},e.wodinFit=function(t,e,r,i,s,a){const u=(0,o.fitTarget)(t,e,r,i,s),c=r.vary.map((t=>r.base[t]));return new n.Simplex(u,c,a)},e.wodinFitValue=function(t,e,r){const{names:n,y:i}=t({mode:a.TimeMode.Given,times:e.time}),s=n.indexOf(r);return(0,o.sumOfSquares)(e.value,i[s])}},394:(t,e)=>{"use strict";function r(t,e){return void 0===t?e:t}Object.defineProperty(e,"__esModule",{value:!0}),e.simplexControl=void 0,e.simplexControl=function(t){void 0===t&&(t={});var e={deltaNonZero:r(t.deltaNonZero,.05),deltaZero:r(t.deltaZero,.001),errorOnFailure:r(t.errorOnFailure,!1),tolerance:r(t.tolerance,1e-5)};if(e.tolerance<=0)throw new Error("Invalid control parameter: 'tolerance' must be strictly positive");return e}},153:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(169);Object.defineProperty(e,"Simplex",{enumerable:!0,get:function(){return n.Simplex}}),Object.defineProperty(e,"fitSimplex",{enumerable:!0,get:function(){return n.fitSimplex}})},169:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Simplex=e.fitSimplex=void 0;var n=r(394),i=r(3);function o(t,e,r){for(var n=e.length,i=new Array(n),o=1+t,s=-t,a=0;a<i.length;++a)i[a]=o*e[a]+s*r[a];return i}e.fitSimplex=function(t,e,r,n){return void 0===r&&(r={}),void 0===n&&(n=200),new s(t,e,r).run(n*e.length)};var s=function(){function t(t,e,r){void 0===r&&(r={}),this.rho=1,this.chi=2,this.psi=-.5,this.sigma=.5,this._iterations=0,this._id=0,this._converged=!1,this._target=t,this._control=n.simplexControl(r),this._n=e.length,this._simplex=[],this._simplex.push(this._point(e.slice())),r.errorOnFailure||(this._target=function(t){return function(e){try{return t(e)}catch(t){return 1/0}}}(t));for(var i=0;i<this._n;++i){var o=e.slice();o[i]?o[i]*=1+this._control.deltaNonZero:o[i]=this._control.deltaZero,this._simplex.push(this._point(o))}this._sort()}return t.prototype.step=function(){if(this._iterations++,this._isConverged())return this._converged=!0,!0;var t=this._n,e=this._simplex[0],r=this._simplex[t],n=this._centroid(),i=this._reflect(r,n);if(i.value<e.value){var o=this._expand(r,n);this._update(o.value<i.value?o:i)}else if(i.value>=this._simplex[t-1].value){var s=i.value>r.value?this._contractInside(r,n):this._contractOutside(r,n);if(s.value<r.value)this._update(s);else{for(var a=1;a<=t;++a)this._simplex[a]=this._shrink(this._simplex[a],e.location);this._sort()}}else this._update(i);return!1},t.prototype.run=function(t){if(!this._converged)for(var e=0;e<t&&!this.step();++e);return this.result()},t.prototype.result=function(){var t=this._simplex[0];return{converged:this._converged,data:t.data,evaluations:this._id,iterations:this._iterations,location:t.location,value:t.value}},t.prototype.simplex=function(){return this._simplex.map((function(t){return{location:t.location,value:t.value}}))},t.prototype._point=function(t){var e=i.checkResult(this._target(t));return{data:e.data,id:this._id++,location:t,value:e.value}},t.prototype._sort=function(){this._simplex.sort((function(t,e){return t.value-e.value}))},t.prototype._centroid=function(){for(var t=this._n,e=new Array(t),r=0;r<t;++r){e[r]=0;for(var n=0;n<t;++n)e[r]+=this._simplex[n].location[r];e[r]/=t}return e},t.prototype._update=function(t){this._simplex[this._n]=t,this._sort()},t.prototype._reflect=function(t,e){return this._point(o(this.rho,e,t.location))},t.prototype._expand=function(t,e){return this._point(o(this.chi,e,t.location))},t.prototype._contractInside=function(t,e){return this._point(o(this.psi,e,t.location))},t.prototype._contractOutside=function(t,e){return this._point(o(-this.psi*this.rho,e,t.location))},t.prototype._shrink=function(t,e){return this._point(o(-this.sigma,e,t.location))},t.prototype._isConverged=function(){for(var t=this._control.tolerance,e=this._simplex[0],r=this._simplex[this._n],n=r.value-e.value<t||1-e.value/r.value<t,i=0,o=0;o<this._n;++o)i=Math.max(i,Math.abs(e.location[o]-r.location[o]));return i<t&&n},t}();e.Simplex=s},3:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.checkResult=void 0,e.checkResult=function(t){return"number"==typeof t?{data:null,value:t}:t}},886:(t,e)=>{"use strict";function r(t,e){return new Error("Invalid control parameter: '".concat(t,"' ").concat(e))}function n(t,e){return void 0===t?e:t}Object.defineProperty(e,"__esModule",{value:!0}),e.dopriControl=void 0,e.dopriControl=function(t){void 0===t&&(t={});var e=1e-6,i=1e4,o=1e-6,s=1/0,a=1e-8,u=!1,c=0,l=1/0,f={atol:n(t.atol,e),maxSteps:n(t.maxSteps,i),rtol:n(t.rtol,o),stepSizeMax:n(t.stepSizeMax,s),stepSizeMin:n(t.stepSizeMin,a),stepSizeMinAllow:n(t.stepSizeMinAllow,u),stiffCheck:n(t.stiffCheck,c),tcrit:n(t.tcrit,l)};if(f.maxSteps<1)throw r("maxSteps","must be at least 1");if(f.atol<=0)throw r("atol","must be strictly positive");if(f.rtol<=0)throw r("rtol","must be strictly positive");return f}},742:function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.DDE=e.integrateDDE=void 0;var o=r(223),s=r(660);e.integrateDDE=function(t,e,r,n,i,o){void 0===i&&(i={}),void 0===o&&(o=null);var s=new a(t,e.length,i,o);return s.initialise(r,e),s.run(n)};var a=function(t){function e(e,r,n,i){void 0===n&&(n={}),void 0===i&&(i=null);var o=this,s=function(t){return o._interpolate(t)},a=null===i?null:function(t,e){return i(t,e,s)};return(o=t.call(this,(function(t,r,n){return e(t,r,n,s)}),r,n,a)||this)._y0=new Array(r),o}return i(e,t),e.prototype.initialise=function(e,r){return this._y0=r,t.prototype.initialise.call(this,e,r),this},e.prototype._interpolate=function(t){var e=this._findHistory(t);return e<0?this._y0.slice(0):this._stepper.interpolate(t,this._history[e])},e.prototype._findHistory=function(t){return(0,s.search)(this._history,(function(e){return e.t>t}))},e}(o.Dopri);e.DDE=a},223:function(t,e,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);i&&!("get"in i?!e.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.prototype.hasOwnProperty.call(t,r)&&n(e,t,r);return i(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Dopri=e.integrateDopri=void 0;var s=r(886),a=o(r(922)),u=r(216),c=o(r(660)),l=Math.pow(2,-52);function f(t,e){return new Error("Integration failure: ".concat(t," at ").concat(e))}e.integrateDopri=function(t,e,r,n,i,o){void 0===i&&(i={}),void 0===o&&(o=null);var s=new h(t,e.length,i,o);return s.initialise(r,e),s.run(n)};var h=function(){function t(t,e,r,n){void 0===r&&(r={}),void 0===n&&(n=null),this._history=[],this._t=0,this._h=0,this._nSteps=0,this._nStepsAccepted=0,this._nStepsRejected=0,this._stiffNStiff=0,this._stiffNNonstiff=0,this._lastError=0,this._stepper=new a.Dopri5(t,e),this._control=(0,s.dopriControl)(r),this._output=n}return t.prototype.initialise=function(t,e){var r=this._stepper.n;if(e.length!==r)throw Error("Invalid size 'y' - expected a length ".concat(r," array"));return this._stepper.reset(t,e),this._reset(),this._h=function(t,e,r,n,i,o){var s=new Array(t.n),a=new Array(t.n),u=new Array(t.n);t.rhs(e,r,s),t.nEval++;var l=0,f=0,h=0;for(h=0;h<t.n;++h){var p=n+i*Math.abs(r[h]);l+=c.square(s[h]/p),f+=c.square(r[h]/p)}var d=l<=1e-10||f<=1e-10?1e-6:.01*Math.sqrt(f/l);for(d=Math.min(d,o),h=0;h<t.n;++h)u[h]=r[h]+d*s[h];t.rhs(e+d,u,a),t.nEval++;var v=0;for(h=0;h<t.n;++h)p=n+i*Math.abs(r[h]),v+=c.square((a[h]-s[h])/p);v=Math.sqrt(v)/d;var y=Math.max(Math.abs(v),Math.sqrt(l)),_=y<=1e-15?Math.max(1e-6,.001*Math.abs(d)):Math.pow(.01/y,1/t.order);return Math.min(Math.min(100*Math.abs(d),_),o)}(this._stepper,t,e,this._control.atol,this._control.rtol,this._control.stepSizeMax),this._t=t,this._history=[],this},t.prototype.run=function(t){for(;this._t<t;)this._step(),this._history.push(this._stepper.history.clone());return(0,u.interpolator)(this._history.slice(0),this._stepper,this._output)},t.prototype.statistics=function(){return{lastError:this._lastError,nEval:this._stepper.nEval,nSteps:this._nSteps,nStepsAccepted:this._nStepsAccepted,nStepsRejected:this._nStepsRejected,stiffNNonstiff:this._stiffNNonstiff,stiffNStiff:this._stiffNStiff}},t.prototype._reset=function(){this._nSteps=0,this._nStepsAccepted=0,this._nStepsRejected=0,this._stiffNStiff=0,this._stiffNNonstiff=0,this._lastError=0},t.prototype._step=function(){for(var t=this._t,e=this._h,r=!1,n=!1,i=Math.max(this._lastError,1e-4),o=this._stepper.stepControl,s=this._control;!r;){if(this._nSteps>s.maxSteps)throw f("too many steps",t);if(e<s.stepSizeMin){if(!s.stepSizeMinAllow)throw f("step too small",t);e=s.stepSizeMin}if(e<=Math.abs(t)*l)throw f("step size vanished",t);t+e>s.tcrit&&(e=s.tcrit-t),this._stepper.step(t,e),this._nSteps++;var a=this._stepper.error(s.atol,s.rtol),u=Math.pow(a,o.constant),h=1/o.factorMin,p=1/o.factorMax;if(a<=1){if(r=!0,this._nStepsAccepted++,this._isStiff(e))throw f("problem became stiff",t);this._stepper.stepComplete(t,e);var d=u/Math.pow(i,o.beta),v=e/(d=c.constrain(d/o.factorSafe,p,h));this._t+=e,this._h=n?Math.min(v,e):Math.min(v,s.stepSizeMax),this._lastError=a}else n=!0,this._nStepsAccepted>=1&&this._nStepsRejected++,e/=Math.min(h,u/o.factorSafe)}return this._t},t.prototype._isStiff=function(t){if(this._stiffNStiff>0||this._nStepsAccepted%this._control.stiffCheck==0)if(this._stepper.isStiff(t)){if(this._stiffNNonstiff=0,this._stiffNStiff++>=15)return!0}else this._stiffNStiff>0&&this._stiffNNonstiff++>=6&&(this._stiffNStiff=0,this._stiffNNonstiff=0);return!1},t}();e.Dopri=h},134:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Dopri5StepControl=void 0;e.Dopri5StepControl=function(){this.factorSafe=.9,this.factorMin=.2,this.factorMax=10,this.beta=.04,this.constant=.2-.75*this.beta}},922:function(t,e,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);i&&!("get"in i?!e.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.prototype.hasOwnProperty.call(t,r)&&n(e,t,r);return i(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Dopri5=void 0;var s=o(r(660)),a=o(r(134)),u=r(430),c=function(){function t(t,e){this.order=5,this.stepControl=new a.Dopri5StepControl,this.nEval=0,this.rhs=t,this.n=e,this.y=new Array(e),this.yNext=new Array(e),this.yStiff=new Array(e),this.k1=new Array(e),this.k2=new Array(e),this.k3=new Array(e),this.k4=new Array(e),this.k5=new Array(e),this.k6=new Array(e),this.history=new u.HistoryElement(this.order*e)}return t.prototype.step=function(t,e){var r=this.n,n=this.y,i=this.yNext,o=this.k1,s=this.k2,a=this.k3,u=this.k4,c=this.k5,l=this.k6,f=this.history.data,h=0;for(h=0;h<r;++h)i[h]=n[h]+.2*e*o[h];for(this.rhs(t+.2*e,i,s),h=0;h<r;++h)i[h]=n[h]+e*(.075*o[h]+.225*s[h]);for(this.rhs(t+.3*e,i,a),h=0;h<r;++h)i[h]=n[h]+e*(.9777777777777777*o[h]+-3.7333333333333334*s[h]+3.5555555555555554*a[h]);for(this.rhs(t+.8*e,i,u),h=0;h<r;++h)i[h]=n[h]+e*(2.9525986892242035*o[h]+-11.595793324188385*s[h]+9.822892851699436*a[h]+-.2908093278463649*u[h]);for(this.rhs(t+.8888888888888888*e,i,c),h=0;h<r;++h)this.yStiff[h]=n[h]+e*(2.8462752525252526*o[h]+-10.757575757575758*s[h]+8.906422717743473*a[h]+.2784090909090909*u[h]+-.2735313036020583*c[h]);var p=t+e;for(this.rhs(p,this.yStiff,l),h=0;h<r;++h)i[h]=n[h]+e*(.09114583333333333*o[h]+.44923629829290207*a[h]+.6510416666666666*u[h]+-.322376179245283*c[h]+.13095238095238096*l[h]);this.rhs(p,i,s);var d=4*r;for(h=0;h<r;++h)f[d++]=e*(-1.1270175653862835*o[h]+2.675424484351598*a[h]+-5.685526961588504*u[h]+3.5219323679207912*c[h]+-1.7672812570757455*l[h]+2.382468931778144*s[h]);for(h=0;h<r;++h)u[h]=e*(.0012326388888888888*o[h]+-.0042527702905061394*a[h]+.03697916666666667*u[h]+-.05086379716981132*c[h]+.0419047619047619*l[h]+-.025*s[h]);this.nEval+=6},t.prototype.stepComplete=function(t,e){this.saveHistory(t,e),s.copyArray(this.k1,this.k2),s.copyArray(this.y,this.yNext)},t.prototype.error=function(t,e){var r=0,n=0;for(n=0;n<this.n;++n){var i=t+e*Math.max(Math.abs(this.y[n]),Math.abs(this.yNext[n]));r+=s.square(this.k4[n]/i)}return Math.sqrt(r/this.n)},t.prototype.interpolate=function(t,e){for(var r=e.data,n=(t-e.t)/e.h,i=1-n,o=this.n,s=new Array(o),a=0;a<o;++a)s[a]=r[a]+n*(r[o+a]+i*(r[2*o+a]+n*(r[3*o+a]+i*r[4*o+a])));return s},t.prototype.isStiff=function(t){for(var e=0,r=0,n=0;n<this.n;++n)e+=s.square(this.k2[n]-this.k6[n]),r+=s.square(this.yNext[n]-this.yStiff[n]);return r>0&&Math.abs(t)*Math.sqrt(e/r)>3.25},t.prototype.reset=function(t,e){for(var r=0;r<this.n;++r)this.y[r]=e[r];this.rhs(t,e,this.k1),this.nEval=1},t.prototype.saveHistory=function(t,e){for(var r=this.history,n=this.n,i=0;i<n;++i){var o=this.yNext[i]-this.y[i],s=e*this.k1[i]-o;r.data[i]=this.y[i],r.data[n+i]=o,r.data[2*n+i]=s,r.data[3*n+i]=-e*this.k2[i]+o-s}r.t=t,r.h=e},t}();e.Dopri5=c},606:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.HistoryElement=void 0;var r=function(){function t(t){this.t=0,this.h=0,this.data=new Array(t)}return t.prototype.clone=function(){var e=new t(this.data.length);return e.t=this.t,e.h=this.h,e.data=this.data.slice(0),e},t}();e.HistoryElement=r},245:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.integrate=e.integrateDDE=e.DDE=e.integrateDopri=e.Dopri=void 0;var n=r(223);Object.defineProperty(e,"Dopri",{enumerable:!0,get:function(){return n.Dopri}}),Object.defineProperty(e,"integrateDopri",{enumerable:!0,get:function(){return n.integrateDopri}});var i=r(742);Object.defineProperty(e,"DDE",{enumerable:!0,get:function(){return i.DDE}}),Object.defineProperty(e,"integrateDDE",{enumerable:!0,get:function(){return i.integrateDDE}});var o=r(961);Object.defineProperty(e,"integrate",{enumerable:!0,get:function(){return o.integrate}})},961:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.integrate=void 0;var n=r(742),i=r(223);e.integrate=function(t,e,r,o,s,a){if(void 0===s&&(s={}),void 0===a&&(a=null),function(t){return 3===t.length}(t)){if(!function(t){return null===t||2===t.length}(a))throw new Error("Can't used delayed output with non-delayed rhs");return(0,i.integrateDopri)(t,e,r,o,s,a)}if(!function(t){return null===t||3===t.length}(a))throw new Error("Can't used non-delayed output with delayed rhs");return(0,n.integrateDDE)(t,e,r,o,s,a)}},216:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.interpolator=void 0,e.interpolator=function(t,e,r){return function(n){return function(t,e,r,n){for(var i=[],o=e,s=0,a=0,u=t;a<u.length;a++){for(var c=u[a];o[s].t+o[s].h<c;)s++;var l=r.interpolate(c,o[s]);null!==n&&(l=l.concat(n(c,l))),i.push(l)}return i}(n,t,e,r)}}},430:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.HistoryElement=void 0;var n=r(606);Object.defineProperty(e,"HistoryElement",{enumerable:!0,get:function(){return n.HistoryElement}})},660:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.search=e.seqLen=e.approxEqualArray=e.approxEqual=e.zeros=e.copyArray=e.constrain=e.square=void 0;var r=Math.pow(2,-26);e.square=function(t){return t*t},e.constrain=function(t,e,r){return Math.max(Math.min(t,r),e)},e.copyArray=function(t,e){for(var r=t.length,n=0;n<r;n++)t[n]=e[n]},e.zeros=function(t){for(var e=Array(t),r=0;r<t;++r)e[r]=0;return e},e.approxEqual=function(t,e,n){void 0===n&&(n=r);var i=Math.abs(t-e),o=Math.abs(t);return o>n&&(i/=o),i<n},e.approxEqualArray=function(t,e,n){if(void 0===n&&(n=r),e.length!==t.length)throw Error("Incompatible arrays");for(var i=0,o=0,s=0,a=0;a<t.length;++a)t[a]!==e[a]&&(i+=Math.abs(t[a]),o+=Math.abs(t[a]-e[a]),s++);return 0===s||(o/=s,(i/=s)>n&&(o/=i),o<n)},e.seqLen=function(t,e,r){for(var n=[],i=0;i<r;++i){var o=i/(r-1);n.push((1-o)*t+o*e)}return n},e.search=function(t,e){var r=0,n=t.length-1;if(0===t.length||e(t[r]))return-1;if(!e(t[n]))return n;for(;n-r>1;){var i=Math.floor((r+n)/2);e(t[i])?n=i:r=i}return r}},907:t=>{"use strict";t.exports=function(t){for(var e=new Array(t),r=0;r<t;++r)e[r]=r;return e}},738:t=>{function e(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}t.exports=function(t){return null!=t&&(e(t)||function(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&e(t.slice(0,0))}(t)||!!t._isBuffer)}},861:(t,e,r)=>{var n=r(907),i=r(738),o="undefined"!=typeof Float64Array;function s(t,e){return t[0]-e[0]}function a(){var t,e=this.stride,r=new Array(e.length);for(t=0;t<r.length;++t)r[t]=[Math.abs(e[t]),t];r.sort(s);var n=new Array(r.length);for(t=0;t<n.length;++t)n[t]=r[t][1];return n}function u(t,e){var r=["View",e,"d",t].join("");e<0&&(r="View_Nil"+t);var i="generic"===t;if(-1===e){var o="function "+r+"(a){this.data=a;};var proto="+r+".prototype;proto.dtype='"+t+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+r+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+r+"(a){return new "+r+"(a);}";return new Function(o)()}if(0===e)return o="function "+r+"(a,d) {this.data = a;this.offset = d};var proto="+r+".prototype;proto.dtype='"+t+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+r+"_copy() {return new "+r+"(this.data,this.offset)};proto.pick=function "+r+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+r+"_get(){return "+(i?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+r+"_set(v){return "+(i?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+r+"(a,b,c,d){return new "+r+"(a,d)}",new Function("TrivialArray",o)(c[t][0]);o=["'use strict'"];var s=n(e),u=s.map((function(t){return"i"+t})),l="this.offset+"+s.map((function(t){return"this.stride["+t+"]*i"+t})).join("+"),f=s.map((function(t){return"b"+t})).join(","),h=s.map((function(t){return"c"+t})).join(",");o.push("function "+r+"(a,"+f+","+h+",d){this.data=a","this.shape=["+f+"]","this.stride=["+h+"]","this.offset=d|0}","var proto="+r+".prototype","proto.dtype='"+t+"'","proto.dimension="+e),o.push("Object.defineProperty(proto,'size',{get:function "+r+"_size(){return "+s.map((function(t){return"this.shape["+t+"]"})).join("*"),"}})"),1===e?o.push("proto.order=[0]"):(o.push("Object.defineProperty(proto,'order',{get:"),e<4?(o.push("function "+r+"_order(){"),2===e?o.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===e&&o.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):o.push("ORDER})")),o.push("proto.set=function "+r+"_set("+u.join(",")+",v){"),i?o.push("return this.data.set("+l+",v)}"):o.push("return this.data["+l+"]=v}"),o.push("proto.get=function "+r+"_get("+u.join(",")+"){"),i?o.push("return this.data.get("+l+")}"):o.push("return this.data["+l+"]}"),o.push("proto.index=function "+r+"_index(",u.join(),"){return "+l+"}"),o.push("proto.hi=function "+r+"_hi("+u.join(",")+"){return new "+r+"(this.data,"+s.map((function(t){return["(typeof i",t,"!=='number'||i",t,"<0)?this.shape[",t,"]:i",t,"|0"].join("")})).join(",")+","+s.map((function(t){return"this.stride["+t+"]"})).join(",")+",this.offset)}");var p=s.map((function(t){return"a"+t+"=this.shape["+t+"]"})),d=s.map((function(t){return"c"+t+"=this.stride["+t+"]"}));o.push("proto.lo=function "+r+"_lo("+u.join(",")+"){var b=this.offset,d=0,"+p.join(",")+","+d.join(","));for(var v=0;v<e;++v)o.push("if(typeof i"+v+"==='number'&&i"+v+">=0){d=i"+v+"|0;b+=c"+v+"*d;a"+v+"-=d}");for(o.push("return new "+r+"(this.data,"+s.map((function(t){return"a"+t})).join(",")+","+s.map((function(t){return"c"+t})).join(",")+",b)}"),o.push("proto.step=function "+r+"_step("+u.join(",")+"){var "+s.map((function(t){return"a"+t+"=this.shape["+t+"]"})).join(",")+","+s.map((function(t){return"b"+t+"=this.stride["+t+"]"})).join(",")+",c=this.offset,d=0,ceil=Math.ceil"),v=0;v<e;++v)o.push("if(typeof i"+v+"==='number'){d=i"+v+"|0;if(d<0){c+=b"+v+"*(a"+v+"-1);a"+v+"=ceil(-a"+v+"/d)}else{a"+v+"=ceil(a"+v+"/d)}b"+v+"*=d}");o.push("return new "+r+"(this.data,"+s.map((function(t){return"a"+t})).join(",")+","+s.map((function(t){return"b"+t})).join(",")+",c)}");var y=new Array(e),_=new Array(e);for(v=0;v<e;++v)y[v]="a[i"+v+"]",_[v]="b[i"+v+"]";for(o.push("proto.transpose=function "+r+"_transpose("+u+"){"+u.map((function(t,e){return t+"=("+t+"===undefined?"+e+":"+t+"|0)"})).join(";"),"var a=this.shape,b=this.stride;return new "+r+"(this.data,"+y.join(",")+","+_.join(",")+",this.offset)}"),o.push("proto.pick=function "+r+"_pick("+u+"){var a=[],b=[],c=this.offset"),v=0;v<e;++v)o.push("if(typeof i"+v+"==='number'&&i"+v+">=0){c=(c+this.stride["+v+"]*i"+v+")|0}else{a.push(this.shape["+v+"]);b.push(this.stride["+v+"])}");return o.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),o.push("return function construct_"+r+"(data,shape,stride,offset){return new "+r+"(data,"+s.map((function(t){return"shape["+t+"]"})).join(",")+","+s.map((function(t){return"stride["+t+"]"})).join(",")+",offset)}"),new Function("CTOR_LIST","ORDER",o.join("\n"))(c[t],a)}var c={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],bigint64:[],biguint64:[],buffer:[],generic:[]};t.exports=function(t,e,r,n){if(void 0===t)return(0,c.array[0])([]);"number"==typeof t&&(t=[t]),void 0===e&&(e=[t.length]);var s=e.length;if(void 0===r){r=new Array(s);for(var a=s-1,l=1;a>=0;--a)r[a]=l,l*=e[a]}if(void 0===n)for(n=0,a=0;a<s;++a)r[a]<0&&(n-=(e[a]-1)*r[a]);for(var f=function(t){if(i(t))return"buffer";if(o)switch(Object.prototype.toString.call(t)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}return Array.isArray(t)?"array":"generic"}(t),h=c[f];h.length<=s+1;)h.push(u(f,h.length-1));return(0,h[s+1])(t,e,r,n)}},863:t=>{"use strict";t.exports=function(t,e,r,n,i){var o,s;for(o=1;o<t;o++){if(0===r[o-1])return console.log("tridiagonalSolve: failed due to lack of diagonal dominance"),!1;s=e[o]/r[o-1],r[o]-=s*n[o-1],i[o]-=s*i[o-1]}if(0===r[t-1])return console.log("tridiagonalSolve: failed due to singular matrix"),!1;for(i[t-1]/=r[t-1],o=t-2;o>=0;o--){if(0===r[o])return console.log("tridiagonalSolve: failed due to singular matrix"),!1;i[o]=(i[o]-n[o]*i[o+1])/r[o]}return!0}},653:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.base=void 0;var n=r(688),i=n.base.maths,o=n.base.user;e.base={maths:i,user:o}},133:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Dust=void 0;var n=r(653),i=r(217),o=r(367),s=r(177),a=function(){function t(t,e,r,o,s){if(r<=0)throw Error("Expected at least one particle");this._Model=t,this._particles=[],this._random=s;for(var a=new t(n.base,e),u=0;u<r;++u)this._particles.push(new i.Particle(a,o))}return t.prototype.nState=function(){return this._particles[0].size},t.prototype.nParticles=function(){return this._particles.length},t.prototype.step=function(){return this._particles[0].step},t.prototype.info=function(){return this._particles[0].info()},t.prototype.setPars=function(t,e){var r=this,o=this.step(),s=(this.nState(),new this._Model(n.base,t));if(s.size()!==this.nState())throw Error("Particle produced unexpected state size");this.forEachParticle((function(t,n){var a=e?void 0:t.state();r._particles[n]=new i.Particle(s,o,a)}))},t.prototype.setStep=function(t){this._particles.forEach((function(e){e.step=t}))},t.prototype.setState=function(t){this.checkState(t),this.forEachParticle((function(e,r){e.setState(t[r])}))},t.prototype.run=function(t){var e=this;this._particles.forEach((function(r){return r.run(t,e._random)}))},t.prototype.simulate=function(t,e){for(var r=null===e?this.nState():e.length,n=this.nParticles(),i=t.length,o=(0,s.dustStateTime)(r,n,i),a=function(r){u.run(t[r]),u.forEachParticle((function(t,n){t.copyState(o.viewParticle(n,r),e)}))},u=this,c=0;c<i;++c)a(c);return o},t.prototype.state=function(t){var e=null===t?this.nState():t.length,r=this.nParticles(),n=(0,o.dustState)(e,r);return this.forEachParticle((function(e,r){e.copyState(n.viewParticle(r),t)})),n},t.prototype.reorder=function(t){var e=this,r=this.nParticles();if(t.length!==r)throw Error("Expected index to have length ".concat(r)+" but given ".concat(t.length));this.forEachParticle((function(n,i){var o=t[i];if(o<0||o>=r)throw Error("Expected index to be in [0, ".concat(r-1,"]")+" but given ".concat(o));n.setState(e._particles[o].state(),!0)})),this.forEachParticle((function(t,e){t.swap()}))},t.prototype.forEachParticle=function(t){this._particles.forEach(t)},t.prototype.checkState=function(t){if(t.length!==this.nParticles())throw Error("Invalid length state, expected ".concat(this.nParticles())+" but given ".concat(t.length));for(var e=0;e<t.length;++e)if(t[e].length!==this.nState())throw Error("Invalid length state for particle ".concat(e,",")+" expected ".concat(this.nState())+" but given ".concat(t[e].length))},t}();e.Dust=a},217:function(t,e){"use strict";var r=this&&this.__spreadArray||function(t,e,r){if(r||2===arguments.length)for(var n,i=0,o=e.length;i<o;i++)!n&&i in e||(n||(n=Array.prototype.slice.call(e,0,i)),n[i]=e[i]);return t.concat(n||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.Particle=void 0;var n=function(){function t(t,e,n){this._model=t,this.step=e,this.size=t.size(),this._y=void 0===n?t.initial(this.step):r([],n,!0),this._yNext=Array(this.size).fill(0)}return t.prototype.info=function(){return this._model.info()},t.prototype.run=function(t,e){for(;this.step<t;)this._model.update(this.step++,this._y,this._yNext,e),this.swap()},t.prototype.state=function(){return this._y},t.prototype.copyState=function(t,e){var r=this._y;if(null===e)for(var n=0;n<r.length;++n)t.set(n,r[n]);else for(n=0;n<e.length;++n)t.set(n,r[e[n]])},t.prototype.setState=function(t,e){void 0===e&&(e=!1);for(var r=e?this._yNext:this._y,n=0;n<t.length;++n)r[n]=t[n]},t.prototype.swap=function(){var t;t=[this._yNext,this._y],this._y=t[0],this._yNext=t[1]},t}();e.Particle=n},177:function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.DustStateTime=e.dustStateTime=void 0;var i=n(r(861)),o=r(367);e.dustStateTime=function(t,e,r){var n=(0,i.default)(new Float64Array(t*e*r),[r,e,t]);return new s(n,t,e,r)};var s=function(){function t(t,e,r,n){this.nState=e,this.nParticles=r,this.nTime=n,this.state=t}return t.prototype.viewTime=function(t){var e=this.state.pick(t,null,null);return new o.DustState(e,this.nState,this.nParticles)},t.prototype.viewParticle=function(t,e){return this.state.pick(e,t,null)},t.prototype.viewState=function(t,e){return this.state.pick(e,null,t)},t.prototype.viewTrace=function(t,e){return this.state.pick(null,e,t)},t.prototype.getParticle=function(t,e){return(0,o.copyVector)(this.viewParticle(t,e))},t.prototype.getState=function(t,e){return(0,o.copyVector)(this.viewState(t,e))},t.prototype.getTrace=function(t,e){return(0,o.copyVector)(this.viewTrace(t,e))},t}();e.DustStateTime=s},367:function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.copyVector=e.DustState=e.dustState=void 0;var i=n(r(861));e.dustState=function(t,e){var r=(0,i.default)(new Float64Array(t*e),[e,t]);return new o(r,t,e)};var o=function(){function t(t,e,r){this.nState=e,this.nParticles=r,this.state=t}return t.prototype.viewParticle=function(t){return this.state.pick(t,null)},t.prototype.viewState=function(t){return this.state.pick(null,t)},t.prototype.getParticle=function(t){return s(this.viewParticle(t))},t.prototype.getState=function(t){return s(this.viewState(t))},t.prototype.asMatrix=function(){for(var t=[],e=0;e<this.nParticles;++e)t.push(this.getParticle(e));return t},t}();function s(t){for(var e=t.shape[0],r=Array(e),n=0;n<e;++n)r[n]=t.get(n);return r}e.DustState=o,e.copyVector=s}},e={};function r(n){var i=e[n];if(void 0!==i)return i.exports;var o=e[n]={exports:{}};return t[n].call(o.exports,o,o.exports,r),o.exports}var n={};(()=>{"use strict";var t=n;Object.defineProperty(t,"__esModule",{value:!0}),t.DustStateTime=t.dustStateTime=t.DustState=t.dustState=t.Particle=t.Dust=t.base=void 0;var e=r(653);Object.defineProperty(t,"base",{enumerable:!0,get:function(){return e.base}});var i=r(133);Object.defineProperty(t,"Dust",{enumerable:!0,get:function(){return i.Dust}});var o=r(217);Object.defineProperty(t,"Particle",{enumerable:!0,get:function(){return o.Particle}});var s=r(367);Object.defineProperty(t,"dustState",{enumerable:!0,get:function(){return s.dustState}}),Object.defineProperty(t,"DustState",{enumerable:!0,get:function(){return s.DustState}});var a=r(177);Object.defineProperty(t,"dustStateTime",{enumerable:!0,get:function(){return a.dustStateTime}}),Object.defineProperty(t,"DustStateTime",{enumerable:!0,get:function(){return a.DustStateTime}})})(),dust=n})();